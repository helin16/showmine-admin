!function(){"use strict";var e,t,n,i=function(i,a,r){e=i,t=a,n=r,t.addPart(n.rootDir.languages),e.useLoader("$translatePartialLoader",{urlTemplate:"{part}{lang}.json"}),e.useLoaderCache("$translationCache"),e.fallbackLanguage(n.default.language),e.preferredLanguage(n.default.language),e.useSanitizeValueStrategy("escapeParameters")};angular.module("shmApp.languages",["pascalprecht.translate"]).config(["$translateProvider","$translatePartialLoaderProvider","appConf",i])}(),function(){"use strict";var e,t,n,i,a,r,o,c,s,u,p,l,m=function(e,t,n,r){var o=function(i,a){var o=this;o.currentSpace=e,o.spaceUsed=t,o.spaceLeft=n,o.fileSize=r,o.cancel=function(){i.dismiss("cancel")}};i.open({animation:!0,templateUrl:a.rootDir.views+"media/alertMediaSize.html",controller:["$uibModalInstance",o],controllerAs:"mdCtrl"})},d=function(n){e.hash(n),t()},g=function(n,i){t.yOffset=i,e.hash(n),t()},f=function(n){e.hash(n),setTimeout(function(){t()},500)},v=function(){d("app-top")},y=function(e){return/^((http[s]?|ftp):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/.test(e)},h=function(e){return new RegExp("^data:image/","i").test(e)},C=function(e){return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)},E=function(e){return h(e)||y(e)},A=function(e){var t={};return t.imgSrc=r.getAppAbsUrlRoot(a.imagesRootDir+"item_default.png"),e.thumbnailArray=r.getImgArray(e.images_in_diff_sizes),e&&e.thumbnailArray&&e.thumbnailArray[0]&&!0===E(e.thumbnailArray[0].url)&&(t.imgSrc=e.images[0].url),t.imgSrc},b=function(e){var t={};return t.imgSrc=r.getAppAbsUrlRoot(a.imagesRootDir+"item_default.png"),e&&e.logo_img&&!0===E(e.logo_img.url)&&(t.imgSrc=e.logo_img.url),t.imgSrc},U=function(e,t){var n={};return n.size_name=t||"LARGE",n.imgDefaultSrc=r.getAppAbsUrlRoot(a.imagesRootDir+"item_default.png"),e.thumbnailArray=r.getImgArray(e.images_in_diff_sizes,n.size_name),n.imgSrc=S(e.thumbnailArray,0),null===n.imgSrc?n.imgDefaultSrc:n.imgSrc},S=function(e,t){return e[t]?!0===e[t].mime_type.toLowerCase().startsWith("image")?e[t].url:S(e,1*t+1):null},I=function(e,t,n){return _.contains(e,t)||n},L=function(e){var t={};return t.imgSrc=r.getAppAbsUrlRoot()+"/app/images/default-avatar.png",e&&e.avatar_img&&!0===E(e.avatar_img)&&(t.imgSrc=e.avatar_img),t.imgSrc},k=function(e){return/^\s*$/.test(e)},D=function(e){k(e),n.pageTitle=e},M=function(e){n.pageDescription=e},T=function(t){var n={};return n.relative_path=void 0===t?"":"/"+t,e.protocol()+"://"+e.host()+":"+e.port()+n.relative_path},w=function(t){var n={};return n.exclude_hash=void 0===t||t,!0===n.exclude_hash?e.absUrl().split("#")[0]:e.absUrl()},O=function(t){var n={};if(n.url=c.href(t.name?t.name:t.current.name,t.params,{absolute:!0}),n.queryParams=e.search(),n.queryParams&&Object.keys(n.queryParams).length>0){if(n.parsedUrl=new URL(n.url),n.missingParams={},angular.forEach(n.queryParams,function(e,t){n.parsedUrl.searchParams.has(t)||(n.missingParams[t]=e)}),!(Object.keys(n.missingParams).length>0))return n.url;!0===n.url.includes("?")?n.url=n.url+"&"+s(n.missingParams):n.url=n.url+"?"+s(n.missingParams)}return n.url},P=function(e){return e?String(e).replace(/&nbsp;/gi,"").replace(/<[^>]+>/gm,""):""},F=function(e){return e?e.replace(/[^a-z0-9\u4e00-\u9eff]/gi,"").toLowerCase():""},R=function(e){var t={addressMap:{}};for(t.i=0;t.i<e.address_components.length;t.i++)t.addressType=e.address_components[t.i].types[0],t.addressMap[t.addressType]=e.address_components[t.i].long_name;return t.address={street:(t.addressMap.street_number?t.addressMap.street_number+" ":"")+(t.addressMap.route?t.addressMap.route:""),suburb:t.addressMap.locality?t.addressMap.locality:t.addressMap.colloquial_area?t.addressMap.colloquial_area:"",state:t.addressMap.administrative_area_level_1?t.addressMap.administrative_area_level_1:"",country:t.addressMap.country?t.addressMap.country:"",postcode:t.addressMap.postal_code?t.addressMap.postal_code:""},e.geometry&&e.geometry.location&&(t.address.latitude=e.geometry.location.lat,t.address.longitude=e.geometry.location.lng),t.address},$=function(e){return{formatted_address:(e.street?e.street+", ":"")+(e.suburb?e.suburb+", ":"")+(e.state?e.state+", ":"")+(e.country?e.country+", ":""),address_components:[{long_name:e.street,short_name:e.street,types:["route"]},{long_name:e.suburb,short_name:e.suburb,types:["locality"]},{long_name:e.state,short_name:e.state,types:["administrative_area_level_1"]},{long_name:e.country,short_name:e.country,types:["country"]},{long_name:e.postal_code,short_name:e.postal_code,types:["postcode"]}],geometry:{location:{lat:function(){return e.latitude},lng:function(){return e.longitude}}}}},x=function(e){e||(e="DEFAULT"),i.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:a.viewRootDir+"directives/user/subscribeAlert.html",controllerAs:"ctrl",controller:["subscribeType","$uibModalInstance",function(e,t){var n=this;return n.type=e,n.$uibModalInstance=t,n.cancel=function(){n.$uibModalInstance.dismiss("cancel")},n}],resolve:{subscribeType:function(){return e}}})},B=function(e,t){var n={};return n.imgArray=[],n.targetSize=void 0===t?"MID":t,e.origImages?(angular.forEach(e.origImages,function(t,i){if("MID"===n.targetSize)n.midImg=e.midImages[i],n.targetImg=n.midImg?n.midImg:t;else if("SMALL"===n.targetSize)n.smallImg=e.smallImages[i],n.targetImg=n.smallImg?n.smallImg:t;else{if("LARGE"!==n.targetSize)return;n.largeImg=e.largeImages[i],n.targetImg=n.largeImg?n.largeImg:t}n.targetImg.comment=t.comment,n.imgArray.push(n.targetImg)}),n.imgArray):n.imgArray},N=function(e){return o.createHash(e)},j=function(e){try{if(e=e||"",""==e.trim())return!0;return void 0!==angular.element(e).attr("meipian-style")}catch(e){return!1}},W=function(e){var t=_.where(e.tags,{type_id:"b6ff88cde7078468bf1da52e5517d548"});return t&&t.length>0?t[0].name:""},G=function(e){var t={};return angular.forEach(e,function(e){var n=moment(moment.utc(e.payment_date)).local().format("YYYY-MM-DD");t[n]||(t[n]={}),t[n].payments||(t[n].payments={}),angular.forEach(e.receipts,function(i){t[n].payments[e.id]||(t[n].payments[e.id]=_.omit(e,"receipts"),t[n].payments[e.id].company=i.item.company),t[n].payments[e.id].items||(t[n].payments[e.id].items={}),t[n].payments[e.id].items[i.item_id]||(t[n].payments[e.id].items[i.item_id]=i.item),t[n].payments[e.id].items[i.item_id].receipts||(t[n].payments[e.id].items[i.item_id].receipts={}),t[n].payments[e.id].items[i.item_id].receipts[i.id]||(t[n].payments[e.id].items[i.item_id].receipts[i.id]=_.omit(i,"item"))})}),t},V=function(e){var t={};return angular.forEach(e,function(e){var n=moment(moment.utc(e.trans_date)).local().format("YYYY-MM-DD");t[n]||(t[n]={}),t[n].items&&t[n].items[e.item_id]||(t[n].items={},t[n].items[e.item_id]=e.item),t[n].items[e.item_id].receipts&&t[n].items[e.item_id].receipts[e.id]||(t[n].items[e.item_id].receipts={},t[n].items[e.item_id].receipts[e.id]=_.omit(e,"item"))}),t},Y=function(e){var t={};return angular.forEach(e,function(e){var n=moment(moment.utc(e.trans_date)).local().format("YYYY-MM-DD");t[n]||(t[n]={}),t[n].items||(t[n].items={}),t[n].items[e.item_id]||(t[n].items[e.item_id]=e.item),t[n].items[e.item_id].receipts||(t[n].items[e.item_id].receipts={}),t[n].items[e.item_id].receipts[e.id]||(t[n].items[e.item_id].receipts[e.id]=_.omit(e,"item"))}),t},z=function(e){var t={};return angular.forEach(e,function(e){if(e.item&&e.item.company_id){var n=moment(moment.utc(e.trans_date)).local().format("YYYY-MM-DD");t[n]||(t[n]={}),t[n].companies||(t[n].companies={}),t[n].companies[e.item.company.id]||(t[n].companies[e.item.company.id]=e.item.company),t[n].companies[e.item.company.id].items||(t[n].companies[e.item.company.id].items={}),t[n].companies[e.item.company.id].items[e.item_id]||(t[n].companies[e.item.company.id].items[e.item_id]=e.item),t[n].companies[e.item.company.id].items[e.item_id].receipts||(t[n].companies[e.item.company.id].items[e.item_id].receipts={}),t[n].companies[e.item.company.id].items[e.item_id].receipts[e.id]||(t[n].companies[e.item.company.id].items[e.item_id].receipts[e.id]=_.omit(e,"item"))}}),t},Q=function(e){var t={};return angular.forEach(e,function(e){var n=moment(moment.utc(e.payment_date)).local().format("YYYY-MM-DD");t[n]||(t[n]={}),t[n].payments||(t[n].payments={}),t[n].payments[e.vendor_payment_group_id]||(t[n].payments[e.vendor_payment_group_id]=e.vendor_payment_group),t[n].payments[e.vendor_payment_group_id].vendors||(t[n].payments[e.vendor_payment_group_id].vendors={}),angular.forEach(e.receipts,function(i){t[n].payments[e.vendor_payment_group_id].vendors[e.id]||(t[n].payments[e.vendor_payment_group_id].vendors[e.id]=_.omit(e,"receipts"),t[n].payments[e.vendor_payment_group_id].vendors[e.id].company=i.item.company),t[n].payments[e.vendor_payment_group_id].vendors[e.id].items||(t[n].payments[e.vendor_payment_group_id].vendors[e.id].items={}),t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id]||(t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id]=i.item),t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id].receipts||(t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id].receipts={}),t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id].receipts[i.id]||(t[n].payments[e.vendor_payment_group_id].vendors[e.id].items[i.item_id].receipts[i.id]=_.omit(i,"item"))})}),t},H=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},J=function(e){var t={modules:{}};return angular.forEach(["group_buy","voucher","note"],function(e){t.modules[e]={create:!1}}),!0===H(e.admin_config)&&(e.admin_config=angular.fromJson(e.admin_config)),e.admin_config&&null!==e.admin_config&&"object"==typeof e.admin_config&&(e.admin_config.is_allow_create_voucher&&!0===e.admin_config.is_allow_create_voucher&&(t.modules.voucher.create=!0),e.admin_config.is_allow_create_news&&!0===e.admin_config.is_allow_create_news&&(t.modules.note.create=!0),e.admin_config.is_allow_create_jielong&&!0===e.admin_config.is_allow_create_jielong&&(t.modules.group_buy.create=!0,e.admin_config.is_allow_multi_pickup&&!0===e.admin_config.is_allow_multi_pickup&&(t.modules.group_buy.pickup_location=!0))),t.modules},q=function(e,t){var i=angular.copy(t);return!0===H(t.config)&&(i.config=angular.fromJson(t.config)),!0===H(t.admin_config)&&(i.admin_config=angular.fromJson(t.admin_config)),t.admin_config||(i.admin_config={}),i.admin_config.currentPackageExpireDate=i.admin_config.currentPackageExpireDate?i.admin_config.currentPackageExpireDate:"2020-12-31 00:00:00",i.admin_config.currentPackage=i.admin_config.currentPackage?i.admin_config.currentPackage:"none",i.modules=J(t),i.isCurrentUserAdmin=e.adminOfCompanyIds&&e.adminOfCompanyIds.indexOf(t.id)>=0,i.isCompanyAdmin=n.appUser.adminOfCompanyIds&&n.appUser.adminOfCompanyIds.indexOf(t.id)>=0,i},K=function(e){if(n.appUser&&n.appUser.userCompany&&0!==n.appUser.userCompany.length)return n.selectedCompany=q(n.appUser,e),u.setItem("selectedCompany_"+n.appUser.id,n.selectedCompany),r},X=function(){if(n.appUser&&n.appUser.id)return u.getItem("selectedCompany_"+n.appUser.id)},Z=function(){if(n.appUser&&n.appUser.id)return u.getItem("all_companies_"+n.appUser.id)},ee=function(e){if(!n.appUser||!n.appUser.id)return r;u.setItem("all_companies_"+n.appUser.id,e)},te=function(e){var t=Z();return t&&t.length>0&&(angular.forEach(t,function(n,i){n.id===e.id&&(t[i]=e)}),ee(t)),t},ne=function(e){var t=angular.copy(e);return!0===H(e.config)&&(t.config=angular.fromJson(e.config)),t},ie=function(){return moment.utc("9999-12-31 23:59:59")},ae=function(){return moment.utc()},re=function(){return{country:"Australia",postcode:"",state:"Victoria",street:"",suburb:""}},oe=function(e,t){return{message:e,errors:t}},ce=function(e){var t={};return t.url=l.trustAsResourceUrl(a.userRegion.checkingAPI),t.params={},e&&(t.params.jsonpCallbackParam=e),p.jsonp(t.url,t.params)},se=function(_,S,J,se,ue,pe,le,me,de,ge,fe){return r=this,r.now=moment(),e=_,t=S,n=J,i=se,a=ue,o=pe,c=le,s=me,u=de,p=ge,l=fe,r.isUrl=y,r.getMaxUtcDateTime=ie,r.getNowUtcDateTime=ae,r.getDefaultAddressObj=re,r.isJsonString=H,r.isDataUrl=h,r.isEmail=C,r.isImageUrl=E,r.getItemDefaultImageUrl=A,r.getCompanyDefaultImageUrl=b,r.getUserAvatarImageUrl=L,r.scrollToTop=v,r.scrollTo=d,r.scrollToWithOffset=g,r.delayScrollTo=f,r.setWebTitle=D,r.setWebDescription=M,r.getAppAbsUrlRoot=T,r.getCurrentUrl=w,r.getCurrentUrlFromPageState=O,r.stripHtmlTags=P,r.isBlank=k,r.mapGoogleMapToAddressObj=R,r.buildGooglePlacesResult=$,r.displaySubscribeModal=x,r.getImgArray=B,r.getItemDefaultThumbnailUrl=U,r.md5Hash=N,r.isConvertableToMeiPianStyleHtml=j,r.returnCommunityNameFromItem=W,r.getUrlSafeString=F,r.adminOfCompany=I,r.processMulvendorPayment=G,r.processReceipt=V,r.processAllReceipt=Y,r.processAllReceiptAllCompanies=z,r.processVendorPaymentWithGroupId=Q,r.setSelectedCompany=K,r.getSelectedCompany=X,r.formatCompany=q,r.getAllStoredCompanies=Z,r.setAllStoredCompanies=ee,r.updateCompanyInAllStoredCompanies=te,r.formatItem=ne,r.getErrorMsgObj=oe,r.getUserRegion=ce,r.alertMediaSize=m,r};angular.module("shmApp.services",["angular-md5"]).service("UtilsService",["$location","$anchorScroll","$rootScope","$uibModal","appConf","md5","$state","$httpParamSerializer","StorageService","$http","$sce",se])}(),function(){"use strict";var e,t,n,i,a,r,o,c={},s=function(e){return c.get(o.url.api()+"wechat/js/conf",{params:e})},u=function(e,t){wx&&"function"==typeof wx.config&&(wx.config(t),g(e,t))},p=function(t){return e.md5Hash(t)},l=function(e,i){var a=angular.fromJson(t.localStorage.getItem(o.localStorageKeyPrefix+"wx"));return a||(a={}),a[p(e)]=i,t.localStorage.setItem(o.localStorageKeyPrefix+"wx",angular.toJson(a)),n},m=function(e){var n=angular.fromJson(t.localStorage.getItem(o.localStorageKeyPrefix+"wx"));return n?n[p(e)]:null},d=function(e){var t={};if(t.stored_config=m(e),"object"==typeof t.stored_config&&t.stored_config&&""!==t.stored_config.timestamp&&(t.now_unix_timestamp=Math.floor(Date.now()/1e3),1*t.now_unix_timestamp-1*t.stored_config.timestamp<=7e3))return t.stored_config},g=function(e,t){return l(e,t),n},f=function(e,t){var i=d(e);return i?(u(e,i),t&&t.loaded&&t.loaded(),n):(n.loadingWechatJsConf=!0,n.loadingWechatJsConfErr=void 0,s({url:e}).then(function(n){n.data&&n.data.js&&(u(e,n.data.js),void 0!==t&&y(t))},function(e){n.loadingWechatJsConfErr=e.data}).finally(function(){n.loadingWechatJsConf=!1}),n)},v=function(e){wx&&"function"==typeof wx.ready&&"function"==typeof e&&wx.ready(function(){e()})},y=function(e){jQuery(document).ready(function(){r(function(){wx.ready(function(t){n.weChatJsLoaded=!0,e.menuShareAppMessage&&wx.onMenuShareAppMessage(e.menuShareAppMessage),e.menuShareTimeline&&wx.onMenuShareTimeline(e.menuShareTimeline),e.getLocation&&wx.getLocation({type:"wgs84",success:function(t){"function"==typeof e.getLocation.success&&e.getLocation.success(t)},fail:function(t){"function"==typeof e.getLocation.fail&&e.getLocation.fail(t)}}),e.loaded&&"function"==typeof e.loaded&&e.loaded(t)})},500)})},h=function(){var e={};return e.userAgent=t.navigator.userAgent.toLowerCase(),!!e.userAgent.match(/MicroMessenger/i)},C=function(){var e={};return e.userAgent=t.navigator.userAgent,!!e.userAgent.match(/(iPad|iPhone|iPod)/g)},E=function(){var e={};return e.userAgent=t.navigator.userAgent,!e.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)},_=function(){var e={};return e.userAgent=t.navigator.userAgent.toLowerCase(),!!e.userAgent.match(/WindowsWechat/i)},A=function(){var e={};return e.userAgent=t.navigator.userAgent.toLowerCase(),!!e.userAgent.match(/Chrome/i)},b=function(){return o.webMainUrl+i.href("auth.getWechatUser",{domain:encodeURIComponent(location.origin),origurl:encodeURIComponent(location.href)},{absolute:!1})},U=function(e){return c.post(o.url.api()+"wechat/me",{state_redirect_obj:e,wechat_auth_url:b()})},S=function(e){return U(e).then(function(e){if(e.data.auth_url)return void(t.location.href=e.data.auth_url)}),n},I=function(e){return c.post(o.url.api()+"wechat/open-platform/generatePreAuthorizationUrl",e)},L=function(e){return c.post(o.url.api()+"wechat/open-platform/bindCompanyWithAppId",e)},k=function(s,u,p,l,m,d,g){return c=s,t=u,e=p,i=l,a=m,r=d,o=g,n=this,n.loadWeChatJsConf=f,n.openedInWeChat=h,n.getAuthPageUrl=b,n.loginAndRedirect=S,n.openInIphone=C,n.openInDesktop=E,n.openInWindowsWechat=_,n.openInGoogleChrome=A,n.runWhenWXReady=v,n.getPreAuthorizationUrl=I,n.bindCompanyWithAppId=L,n};angular.module("shmApp.services").service("WeChatService",["$http","$window","UtilsService","$state","$auth","$timeout","appConf",k])}(),function(){"use strict";var e,t,n,i,a={},r=function(t){return a.post(e.url.api()+"user/login",t)},o=function(){i.clear(),t.setToken(""),t.logout()},c=function(){return a.get(e.url.api()+"user/me")},s=function(t,n){return a.get(e.url.api()+"wechat/getUser",{params:{code:t,state:n}})},u=function(t){return a.post(e.url.api()+"wechat/web/connect/url",t)},p=function(t,n){return a.get(e.url.api()+"wechat/web/getUser",{params:{code:t,state:n}})},l=function(e){t.setToken(e)},m=function(){return t.getToken()},d=function(){return!!t.isAuthenticated()&&(!n.appUser&&void 0!==n.appUser&&""!=n.appUser.id)},g=function(t){return a.get(e.url.api()+"social-login/"+t)},f=function(t,n){return a.get(e.url.api()+"social-login/"+t+"/callback",{params:{code:n}})},v=function(t,n){return a.get(e.url.api()+"social-login/facebook/companyRedirect")},y=function(t){return a.get(e.url.api()+"social-login/facebook/companyBind",{params:{code:t}})},h=function(t){return a.post(e.url.api()+"user/validateLoginCode",{login_code:t})},C=function(){return a.post(e.url.api()+"user/generateLoginSubscribeQr")},E=function(t,n){return a.get(e.url.api()+"user/checkSubscribeLoginLog/"+t,{params:n})},_=function(_,A,b,U,S){return a=_,e=A,t=b,n=U,i=S,{login:r,loginWithTempCode:h,logout:o,isAuthenticated:d,getWechatLoginUrl:u,getWechatUserFromCode:s,getWechatWebUserFromCode:p,getMe:c,setAuthToken:l,getAuthToken:m,getSocialMediaLoginRedirectUrl:g,getSocialMediaUserFromCode:f,facebookPageCompanyRedirect:v,facebookPageBindWithCode:y,generateLoginQrCode:C,checkLoginStatus:E}};angular.module("shmApp.services").service("AuthService",["$http","appConf","$auth","$rootScope","StorageService",_])}(),function(){"use strict";var e,t,n,i=function(i,a){return e.localStorage.setItem(t.localStorageKeyPrefix+i,angular.toJson(a)),n},a=function(n){var i=e.localStorage.getItem(t.localStorageKeyPrefix+n);return angular.fromJson(i)},r=function(i){return e.localStorage.removeItem(t.localStorageKeyPrefix+i),n},o=function(){return e.localStorage.clear(),n},c=function(c,s){return e=c,t=s,n=this,n.setItem=i,n.getItem=a,n.removeItem=r,n.clear=o,n};angular.module("shmApp.services").service("StorageService",["$window","appConf",c])}(),function(){"use strict";var e,t={},n=function(n){return t.get(e.url.api()+"banner/company/"+n)},i=function(n,i){return t.post(e.url.api()+"banner/company/"+n,{banners:i})},a=function(n,i){return t.put(e.url.api()+"asset/"+n+"/comment",i)},r=function(r,o){return t=r,e=o,{getCompanyBanners:n,createCompanyBanner:i,updateBannerComment:a}};angular.module("shmApp.services").service("BannerService",["$http","appConf",r])}(),function(){"use strict";var e,t={},n=function(n){return t.post(e.url.api()+"company",n)},i=function(n,i){return t.put(e.url.api()+"company/"+n,i)},a=function(n){return t.get(e.url.api()+"company/"+n)},r=function(n){return t.get(e.url.api()+"company/assetsSize/"+n)},o=function(n){return t.get(e.url.api()+"company/mediaSpaceSize/"+n)},c=function(n,i){return t.get(e.url.api()+"company/assets/"+n,{params:i})},s=function(n){return t.post(e.url.api()+"company/"+n+"/genCompanyPageQrCode")},u=function(n,i){return t.post(e.url.api()+"company/"+n+"/approveCompanyStaff",i)},p=function(n){return t.delete(e.url.api()+"company/"+n)},l=function(n){return t.get(e.url.api()+"company",{params:n})},m=function(n,i){return t.get(e.url.api()+"company/user/"+n,{params:i})},d=function(n,i,a){return t.post(e.url.api()+"company/user/"+n+"/"+i,a)},g=function(n,i){return t.delete(e.url.api()+"company/user/"+n+"/"+i)},f=function(n,i,a){return t.put(e.url.api()+"company/user/"+n+"/"+i,a)},v=function(n,i){return t.post(e.url.api()+"company/messages/"+n,i)},y=function(n,i){return t.put(e.url.api()+"company/messages/"+n,i)},h=function(n,i){return t.delete(e.url.api()+"company/messages/"+n,i)},C=function(n,i){return t.get(e.url.api()+"company/messages/"+n,{params:i})},E=function(n,i){return t.get(e.url.api()+"company/messages/list/"+n,{params:i})},_=function(n){return t.post(e.url.api()+"company/fav",{company_id:n})},A=function(n){return t.delete(e.url.api()+"company/fav",{params:{company_id:n}})},b=function(n){return t.get(e.url.api()+"company/fav",{params:n})},U=function(n){return t.get(e.url.api()+"company/section/"+n)},S=function(n,i){return t.post(e.url.api()+"company/section/"+n,{companySection:i})},I=function(n,i){return t.put(e.url.api()+"company/display/"+n,i)},L=function(n,i){return t.post(e.url.api()+"company/sendMessage/"+n,i)},k=function(n){return t.post(e.url.api()+"company/apply",n)},D=function(n,i){return t.get(e.url.api()+"company/validateApplication/"+n,{params:i})},M=function(n){return t.post(e.url.api()+"domain",{domain:n})},T=function(n,i){return t.post(e.url.api()+"company/broadcastArticles/"+n,i)},w=function(n){return t.post(e.url.api()+"company/bindFacebook",n)},O=function(n,i){return t.post(e.url.api()+"company/captcha/"+n,i)},P=function(n){return t.get(e.url.api()+"company/location/"+n)},F=function(n,i){return t.post(e.url.api()+"company/location/"+n,i)},R=function(n,i,a){return t.put(e.url.api()+"company/location/"+n+"/"+i,a)},$=function(n,i){return t.delete(e.url.api()+"company/location/"+n+"/"+i)},x=function(n,i){return t.get(e.url.api()+"company/voucher-group/company/"+n,{params:i})},B=function(n){return t.get(e.url.api()+"company/voucher-group/"+n)},N=function(n){return t.post(e.url.api()+"company/voucher-group",n)},j=function(n,i){return t.put(e.url.api()+"comment/voucher/"+n+"/markSent",i)},W=function(n){return t.post(e.url.api()+"company/voucher-group/"+n+"/obtainOwnership")},G=function(){return t.post(e.url.api()+"company/voucher-group/fetchVoucherRandomly")},V=function(n){return t.post(e.url.api()+"company/voucher-campaign",n)},Y=function(n){return t.get(e.url.api()+"company/voucher-campaign/"+n)},z=function(n,i){return t.put(e.url.api()+"company/voucher-campaign/"+n,i)},Q=function(n,i){return t.get(e.url.api()+"company/voucher-campaign/company/"+n,{params:i})},H=function(n){return t.get(e.url.api()+"company/voucher-campaign",{params:n})},J=function(n){return t.post(e.url.api()+"company/voucher-campaign/"+n+"/fetchVoucherRandomly")},q=function(n,i){return t.get(e.url.api()+"company/voucher-campaign/"+n+"/voucherUsersUnderCampaign",{params:i})},K=function(n){return t.get(e.url.api()+"company/voucher-group/companies",{params:n})},X=function(n,i){return t.put(e.url.api()+"company/voucher-group/"+n,i)},Z=function(n){return t.get(e.url.api()+"company/paid/companies",{params:n})},ee=function(n){return t.post(e.url.api()+"company/voucher-group/preview",n)},te=function(n,i){return t.get(e.url.api()+"wechat/card/assignCard/"+n,{params:i})},ne=function(n,i){return t.put(e.url.api()+"company/voucher-group/cancel/"+n+"/"+i)},ie=function(n){return t.post(e.url.api()+"company/voucher-group/share/"+n)},ae=function(n,i){return t.post(e.url.api()+"company/"+n+"/genAddUserQRCode",i)},re=function(n,i){return t.post(e.url.api()+"company/voucher-group/"+n+"/genVoucherQrCode",i)},oe=function(n){return t.get(e.url.api()+"company/"+n+"/tags")},ce=function(ce,se){return t=ce,e=se,{deactivateCompany:p,updateInfo:i,createInfo:n,getCompanyDetails:a,getCompanyAssetsSize:r,getCompanyAssets:c,createNewCompanyUser:d,getUserList:m,deleteCompanyUser:g,updateCompanyUser:f,getAllCompanies:l,updateComment:y,addCommentToAnCompany:v,deleteCompanyComment:h,getCompanyComments:E,markAsFavourite:_,removeAsFavourite:A,getFavCompanies:b,getACompanyComment:C,getCompanySections:U,createCompanySections:S,displayCompanyItems:I,applyCompany:k,checkApplicationStatus:D,getByDomain:M,broadcastItemsToWechat:T,bindFacebookWithPage:w,sendMessageToCompany:L,createCaptcha:O,getCompanyPickupLocations:P,createCompanyPickupLocation:F,updateCompanyPickupLocation:R,deleteCompanyPickupLocation:$,getVoucherGroupsUnderCompany:x,getVoucherGroupById:B,createCompanyVoucherGroup:N,markVoucherSent:j,obtainVoucherOwnership:W,obtainRandomVoucherOwnership:G,createCompanyVoucherCampaign:V,getCompanyVoucherCampaignDetails:Y,updateCompanyVoucherCampaignDetails:z,getCompanyCampaignList:Q,getAllCampaignList:H,obtainRandomVoucherUnderCampaign:J,getCampaignUsersLists:q,getCompaniesWithVoucherGroups:K,updateCompanyVoucherGroup:X,getPaidCompanies:Z,previewVoucher:ee,assignCard:te,cancelCompanyVoucherGroup:ne,sendWeChatNewsOfVoucherGroup:ie,genAddUserQRCode:ae,getCompanyQrcodes:s,genVoucherQrCode:re,approveCompanyStaff:u,getCompanyTags:oe,getCompanyMediaSpaceSize:o}};angular.module("shmApp.services").service("CompanyService",["$http","appConf",ce])}(),function(){"use strict";var e,t={},n=function(n,i){return t.get(e.url.api()+"item/seller/"+n,{params:i})},i=function(n){return t.get(e.url.api()+"item/"+n)},a=function(n){return t.post(e.url.api()+"item",n)},r=function(n,i){return t.put(e.url.api()+"item/"+n,i)},o=function(n){return t.post(e.url.api()+"payment/receipt",n)},c=function(n,i){return t.post(e.url.api()+"comment/item/"+n,i)},s=function(n,i){return t.post(e.url.api()+"jielong/"+n+"/subitems",i)},u=function(n,i){return t.put(e.url.api()+"jielong/"+n+"/subitems",i)},p=function(n,i){return t.get(e.url.api()+"comment/item/"+n,{params:i})},l=function(n,i){return t.get(e.url.api()+"jielong/isInJielong/"+n,i)},m=function(n,i){return t.get(e.url.api()+"jielong/getAllJielong/"+n,i)},d=function(n,i){return t.put(e.url.api()+"comment/"+n,i)},g=function(n,i){return t.get(e.url.api()+"comment/"+n,i)},f=function(n,i){return t.delete(e.url.api()+"comment/"+n,{params:i})},v=function(n){return t.get(e.url.api()+"item/search",{params:n})},y=function(n,i){return t.get(e.url.api()+"item/community/"+n,{params:i})},h=function(n,i){return t.get(e.url.api()+"item/company/"+n,{params:i})},C=function(n,i){return t.get(e.url.api()+"item/company/"+n+"/onlinePayment",{params:i})},E=function(n,i){return t.get(e.url.api()+"item/company/"+n+"/consultation",{params:i})},_=function(n,i){return t.get(e.url.api()+"item/company/"+n+"/product",{params:i})},A=function(n,i){var a={};return a.parameters=i||{},a.parameters.community_id=e.community.group_buy.id,t.get(e.url.api()+"item/company/"+n,{params:a.parameters})},b=function(n,i){return t.put(e.url.api()+"item/"+n+"/end",i)},U=function(n,i){return t.put(e.url.api()+"item/"+n+"/sold",i)},S=function(n,i){return t.delete(e.url.api()+"item/"+n,i)},I=function(n,i){return t.post(e.url.api()+"item/"+n+"/abuse",i)},L=function(n,i){return t.get(e.url.api()+"item/"+n+"/pushTimes",i)},k=function(n,i){return t.put(e.url.api()+"item/"+n+"/push",i)},D=function(){return t.get(e.url.api()+"tag/predefined")},M=function(n){return t.get(e.url.api()+"jielong/blacklist",{params:n})},T=function(n){return t.get(e.url.api()+"jielong/blacklist/blacklistdetails",{params:n})},w=function(n){return t.get(e.url.api()+"utils/places-overseas",n)},O=function(n){return t.get(e.url.api()+"utils/geoip/isFromChina",n)},P=function(n,i,a){return t.post(e.url.api()+"item/poster/"+n,{url:i,is_showing_all_imgs:a})},F=function(n,i){return t.post(e.url.api()+"item/checkinqr/"+n,{url:i})},R=function(n,i){return t.post(e.url.api()+"item/checkin/"+n,{url:i})},$=function(n,i){return t.put(e.url.api()+"item/"+n+"/seller",{seller_id:i})},x=function(n,i){return t.get(e.url.api()+"item/"+n+"/guessYouLikeByTags",{params:i})},B=function(n){return t.get(e.url.api()+"item/guessYouLike",{params:n})},N=function(n){return t.get(e.url.api()+"item/history",{params:n})},j=function(n){return t.post(e.url.api()+"item/clone/"+n)},W=function(n,i){var a=i||{};return a.item_id=n,t.post(e.url.api()+"item/fav",a)},G=function(n,i){var a=i||{};return a.item_id=n,t.delete(e.url.api()+"item/fav",{params:a})},V=function(n){return t.get(e.url.api()+"item/fav",{params:n})},Y=function(n){return t.get(e.url.api()+"item/propertytype",{params:n})},z=function(n){return t.get(e.url.api()+"comment/voucher/"+n)},Q=function(n){return t.get(e.url.api()+"comment/voucher/"+n+"/validate")},H=function(n,i){return t.post(e.url.api()+"comment/voucher/"+n,i)},J=function(n,i){return t.post(e.url.api()+"comment/voucher/"+n+"/subitems",i)},q=function(n){return t.get(e.url.api()+"comment/voucher",{params:n})},K=function(n,i){return t.put(e.url.api()+"jielong/checkin/finish/"+n,i)},X=function(n){return t.get(e.url.api()+"item/topVisited",{params:n})},Z=function(n){return t.get(e.url.api()+"item/getItemsWithSpeicalTags",{params:n})},ee=function(n,i){return t.get(e.url.api()+"item/company/getItemsWithCompanyTags/"+n,{params:i})},te=function(n,i){return t.post(e.url.api()+"/jielong/"+n+"/genReportEmail",i)},ne=function(n,i,a){return t.get(e.url.api()+"comment/item/"+n+"/"+i,{params:a})},ie=function(n,i){return t.post(e.url.api()+"item/"+n+"/facebook",{params:i})},ae=function(n,i){return t.post(e.url.api()+"item/"+n+"/wordpress",{params:i})},re=function(e){return e&&e.id?1!==parseInt(e.active)?"DEACTIVATED":!0===e.is_sold?"SOLD":!0===e.is_ended?"ENDED":1==e.is_draft?"DRAFT":!0===e.is_expired?"EXPIRED":!0!==e.is_published?"NOT_STARTED":"ACTIVE":""},oe=function(n,i){return t.get(e.url.api()+"item/company/validateItemLimit/"+n,{params:i})},ce=function(n,i){return t.get(e.url.api()+"item/"+n+"/history",{params:i})},se=function(n){return t.post(e.url.api()+"item/"+n+"/genItemQrCode")},ue=function(ue,pe){return t=ue,e=pe,{getItemsForASeller:n,searchItems:v,searchItemsUnderCommunity:y,searchItemsUnderCompany:h,addCommentToAnItem:c,createItem:a,updateItem:r,createReceipt:o,getCommentsForAnItem:p,getItemDetails:i,reportItemAbuse:I,getLeftPushTimes:L,pushItem:k,markItemEnd:b,markItemSold:U,markItemDeactivate:S,getPredefinedTags:D,getPlacesOverseas:w,generateItemPoster:P,getIsFromChina:O,guessCurrentUserLike:B,guessUserLikeByTags:x,updateComment:d,getComment:g,setCommentsDeactivate:f,getMyHistory:N,getFavItems:V,cloneItem:j,markAsFavourite:W,removeAsFavourite:G,updateSeller:$,getIsInJielong:l,getAllJielong:m,generateCheckinQRCode:F,generateCheckinPoster:R,getPropertyTypes:Y,getVoucherDetails:z,checkinVoucher:H,checkinVoucherWithSubItems:J,getMyVouchers:q,terminateJielong:K,getTopVisitItemsList:X,addJielongToAnItemWithKids:s,updateJielongToAnItemWithKids:u,getItemStatusName:re,searchItemsUnderCompanyOnlyForProduct:_,searchItemsUnderCompanyOnlyForGroupBuy:A,searchBlackList:M,getItemsWithSpeicalTags:Z,getBlackListDetails:T,getItemsWithCompanyTags:ee,checkIfComanyUpperTheItemLimit:oe,searchItemsUnderCompanyWithOnlinePayment:C,validateVoucherWhenNoUser:Q,genJielongReportEmail:te,searchItemsUnderCompanyOnlyForConsultation:E,getItemHistories:ce,updateJielongReportLocationData:ne,pushToFacebook:ie,pushToWordpress:ae,getItemQrCodes:se}};angular.module("shmApp.services").service("ItemService",["$http","appConf",ue])}(),function(){"use strict";var e,t,n,i,a,r=["simplified-chinese","australia"],o=function(t){return e.use(t),"simplified-chinese"===t?i.changeLocale("zh-cn"):"australia"===t&&i.changeLocale("en"),a.setItem("selected-language",t),n},c=function(){var t={};return t.langKey=a.getItem("selected-language"),t.langKey&&null!==t.langKey&&""!==t.langKey||(t.langKey=e.use()),t.langKey},s=function(){return r},u=function(r,u,p,l){return e=r,t=u,i=p,a=l,n=this,n.switchLanguage=o,n.getLocalLanguageKey=c,n.getSupportedLanguages=s,n};angular.module("shmApp.services").service("LanguageService",["$translate","appConf","amMoment","StorageService",u])}(),function(){"use strict";var e,t,n,i=function(){var e=document.createElement("script")
;e.src="https://ditu.google.cn/maps/api/js?libraries=places&key="+n.external_keys.google_map+"&callback=initialize",e.async="",e.defer="",document.body.appendChild(e)},a=function(a,r,o){e=a,t=r,n=o;var c=t.defer();return e.initialize=function(){c.resolve()},i(),c.promise};angular.module("shmApp.services").service("loadGoogleMapLib",["$window","$q","appConf",a])}(),function(){"use strict";var e,t,n={},i={width:1200,height:8e3,quality:.8},a=function(e){return n.post(t.url.api()+"asset/wechat",e)},r=function(e,i){return n.put(t.url.api()+"asset/"+e+"/comment",i)},o=function(n,i){return e.upload({url:t.url.api()+"asset/"+i,file:n})},c=function(e){return n.post(t.url.api()+"asset/based64",e)},s=function(t){return e.resize(t,i)},u=function(e){return n.delete(t.url.api()+"asset/"+e)},p=function(i,p,l){return n=i,t=l,e=p,{uploadThoughWechat:a,updateAssetComment:r,uploadAsset:o,imgResize:s,uploadBase64Asset:c,deleteAsset:u}};angular.module("shmApp.services").service("AssetService",["$http","Upload","appConf",p])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"AE",scope:{appUser:"<"},template:"",link:function(n,a,r){n.appConf=e;var o={};t.current.data.pageTitle&&(o.pageTitle=angular.element('<div class="title"></div>'),o.pageTitle.append(t.current.data.pageTitle),i(o.pageTitle)(n),a.append(o.pageTitle)),t.current.data.pageSubTitle&&(o.subTitle=angular.element('<div class="subtitle"></div>'),angular.isArray(t.current.data.pageSubTitle)?angular.forEach(t.current.data.pageSubTitle,function(e){o.subTitle.append('<div class="subtitle-part">'+e+"</div>")}):o.subTitle.append('<div class="subtitle-part">'+t.current.data.pageSubTitle+"</div>"),i(o.subTitle)(n),a.append(o.subTitle)),t.current.data.btn&&(o.btnWrapper=angular.element('<div class="btn-wrapper"></div>'),o.btnWrapper.append('<div class="btn-part">'+t.current.data.btn+"</div>"),i(o.btnWrapper)(n),a.append(o.btnWrapper))}}};angular.module("shmApp.directives").directive("backendPageTitle",["appConf","$state","$rootScope","$compile",e])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{appUser:"<?"},templateUrl:e.rootDir.views+"backend/bottomMenu.html"}};angular.module("shmApp.directives").directive("bottomMenu",["appConf",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<"},templateUrl:e.rootDir.views+"backend/brandDiv.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("brandDiv",["appConf","$rootScope",e])}(),function(){"use strict";var e=function(e,t,n){return{restrict:"AE",scope:{appUser:"<"},templateUrl:e.rootDir.views+"backend/toggleLeftMenuWidthBtn.html",link:function(e,i,a){e.toggleMinLeftMenu=function(){t.showMinLeftMenu=!0!==t.showMinLeftMenu,n.setItem("showMinLeftMenu",t.showMinLeftMenu)},t.showMinLeftMenu=n.getItem("showMinLeftMenu")}}};angular.module("shmApp.directives").directive("toggleLeftMenuWidthBtn",["appConf","$rootScope","StorageService",e])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{appUser:"<?"},templateUrl:e.rootDir.views+"backend/topMenu.html"}};angular.module("shmApp.directives").directive("topMenu",["appConf",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"banner/bannerList.html",link:function(e,n,i){e.getBanners=function(){e.gettingBanners=!0,e.gettingBannersErr=void 0,t.getCompanyBanners(e.company.id).then(function(t){e.banners=t.data},function(t){e.gettingBannersErr=t.data}).finally(function(){e.gettingBanners=void 0})},e.saveCompanyBanners=function(n){if(n){var i={};i.comment=n.asset.comment||"",e.savingBanners=!0,e.savingBannerErr=void 0,t.updateBannerComment(n.asset.id,i).then(function(e){},function(t){e.savingCommentErr=t.data})}t.createCompanyBanner(e.company.id,e.banners).then(function(e){},function(t){e.savingBannerErr=t.data}).finally(function(){e.savingBanners=void 0})},e.removeBannerFromBanners=function(t){e.banners=_.without(e.banners,t),e.saveCompanyBanners()},e.getBanners(),e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin}}};angular.module("shmApp.directives").directive("bannerList",["appConf","BannerService",e])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{appUser:"<",banner:"<",company:"<",editMode:"<?",callBackSave:"&?",callBackDelete:"&?"},templateUrl:e.rootDir.views+"banner/bannerListItem.html",link:function(e,t,n){e.goEditMode=function(){e.editMode=!0},e.cancelEditMode=function(){angular.copy(e.banner,e.tmpBanner),e.editMode=!1},e.saveChange=function(){e.editMode=!1,e.tmpBanner.asset.id===e.banner.asset.id&&e.tmpBanner.link_to===e.banner.link_to&&e.tmpBanner.asset.comment===e.banner.asset.comment||(angular.copy(e.tmpBanner,e.banner),e.callBackSave()(e.banner))},e.deleteBanner=function(){e.callBackDelete(e.banner)},e.editMode=!1,e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin,e.tmpBanner=angular.copy(e.banner)}}};angular.module("shmApp.directives").directive("bannerListItem",["appConf",e])}(),function(){"use strict";var e=function(e,t,n,i){var a=this;a.appUser=t,a.company=n,a.banners=i,a.newBanner={link_to:"",asset:{}},a.assetArray=[],a.cancel=function(){e.dismiss("cancel")},a.save=function(){if(!a.assetArray[0]||!a.assetArray[0].id)return a.newBannerErr=!0,!1;a.newBanner.asset=a.assetArray[0],a.banners.push(a.newBanner),e.close(a.newBanner)}},t=function(t,n){return{restrict:"A",scope:{appUser:"<",company:"<",banners:"<",succFunc:"&?"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"banner/bannerCreatePanel.html",controller:["$uibModalInstance","appUser","company","banners",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},company:function(){return i.company},banners:function(){return i.banners}}}).result.then(function(e){"function"==typeof i.succFunc&&"function"==typeof i.succFunc()&&i.succFunc()(e)})})}}};angular.module("shmApp.directives").directive("bannerCreatePanel",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n){var i=this;i.appUser=t,i.banner=n,i.cancel=function(){e.dismiss("cancel")},i.delete=function(){e.close()}},t=function(t,n){return{restrict:"A",scope:{appUser:"<",banner:"=",confirmFunc:"&?"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"banner/bannerDeleteConfirmBtn.html",controller:["$uibModalInstance","appUser","banner",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},banner:function(){return i.banner}}}).result.then(function(){"function"==typeof i.confirmFunc&&"function"==typeof i.confirmFunc()&&i.confirmFunc()()})})}}};angular.module("shmApp.directives").directive("bannerDeleteConfirmBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a){var r=this;r.appUser=t,r.company=n,r.cancel=function(){e.dismiss("cancel")},r.delete=function(){return r.company_name&&""!==r.company_name?r.company_name!==r.company.name?void(r.deletingErr={message:a.instant("COMPANY.DELETE.ERROR.NAME_DIFFERENT")}):(r.deleting=!0,r.deletingErr=void 0,void i.deactivateCompany(r.company.id).then(function(t){e.close(t.data)},function(e){r.deletingErr=e.data}).finally(function(){r.deleting=void 0})):void(r.deletingErr={message:a.instant("COMPANY.DELETE.ERROR.NAME_REQUIRED")})}},t=function(t,n,i,a){return{restrict:"AE",scope:{appUser:"<",company:"<"},link:function(r,o,c){o.on("click",function(){i.open({animation:!0,templateUrl:t.rootDir.views+"company/companyDeleteConfirmPanel.html",controller:["$uibModalInstance","appUser","company","CompanyService","$translate",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return r.appUser},company:function(){return r.company}}}).result.then(function(e){n.setSelectedCompany(e),n.updateCompanyInAllStoredCompanies(e),a.location.reload()})})}}};angular.module("shmApp.directives").directive("companyDeleteBtn",["appConf","UtilsService","$uibModal","$window",t])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"AE",scope:{companyExpiredInfoPanel:"<"},link:function(e,a,r){var o={};e.appUser=t.appUser,e.company=n.formatCompany(e.appUser,e.companyExpiredInfoPanel),!0===e.company.is_expired&&(o.html='<div class="company-expired-info-panel-wrapper"><div class="alert alert-danger company-expired-info-panel"><div class="text-center"><strong translate="COMPANY.EXPIRED.INFO.PANEL.BODY" translate-values="{\'company_name\': company.name, \'expired_at\': (company.admin_config.currentPackageExpireDate | amUtc | amLocal | amDateFormat: \'ll\')}"></strong></div><ask-customer-service-panel></ask-customer-service-panel></div></div>',o.newElement=i(o.html)(e),a.replaceWith(o.newElement))}}};angular.module("shmApp.directives").directive("companyExpiredInfoPanel",["appConf","$rootScope","UtilsService","$compile",e])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"A",scope:{companyNotHaveThisModuleInfoPanel:"<",moduleName:"@"},link:function(e,a,r){var o={};e.appUser=t.appUser,e.company=n.formatCompany(e.appUser,e.companyNotHaveThisModuleInfoPanel),e.company.modules[e.moduleName.toLowerCase()]&&e.company.modules[e.moduleName.toLowerCase()].create&&!0===e.company.modules[e.moduleName.toLowerCase()].create||(o.html='<div class="company-not-have-this-module-info-panel-wrapper"><div class="alert alert-warning company-not-have-this-module-info-panel"><div class="text-center"><strong translate="COMPANY.NOT_HAVING_THIS_MODULE.INFO.PANEL.BODY" translate-values="{\'company_name\': company.name, \'module_name\': (moduleName.toUpperCase() | translate)}"></strong></div><ask-customer-service-panel ng-if="appUser.is_admin !== true" btn-text="{{\'CUSTOMER_SERVICE.CLICK_HERE_TO_ENABLE_THIS_MODULE\' | translate}}"></ask-customer-service-panel></div></div>',o.newElement=i(o.html)(e),!0===e.appUser.is_admin?a.prepend(o.newElement):a.replaceWith(o.newElement))}}};angular.module("shmApp.directives").directive("companyNotHaveThisModuleInfoPanel",["appConf","$rootScope","UtilsService","$compile",e])}(),function(){"use strict";var e=function(e,t,n,i,a){return{restrict:"AE",scope:{appUser:"<",company:"<",cancelFunc:"&?",saveSuccessFunc:"&?",pickupLocation:"<?"},templateUrl:e.rootDir.views+"company/companyPickupLocationEdit.html",link:function(e,r,o){if(e.cancel=function(){!0===e.hasCancelFunc&&e.cancelFunc()()},e.save=function(){var n={};e.saving=!0,e.savingErr=void 0,n.saveFunc=e.pickupLocation&&e.pickupLocation.id?t.updateCompanyPickupLocation(e.company.id,e.pickupLocation.id,e.pickupLocation):t.createCompanyPickupLocation(e.company.id,e.pickupLocation),n.saveFunc.then(function(t){e.pickupLocation=t.data,"function"==typeof e.saveSuccessFunc&&"function"==typeof e.saveSuccessFunc()&&e.saveSuccessFunc()(e.pickupLocation)},function(t){e.savingErr=t.data}).finally(function(){e.saving=void 0})},e.hasCancelFunc="function"==typeof e.cancelFunc&&"function"==typeof e.cancelFunc(),e.company=n.formatCompany(e.appUser,e.company),!0!==a.appUser.is_admin)if(!0!==e.company.isCompanyAdmin)r.remove();else if(!0===e.company.is_expired){var c=angular.element("<ask-customer-service-panel title=\"{{'COMPANY_EXPIRED' | translate}}\" btn-text=\"{{'CUSTOMER_SERVICE.CLICK_HERE_TO_EXTEND_EXPIRY_DATE' | translate}}\"></ask-customer-service-panel>");i(c)(e),r.replaceWith(c)}else if(e.company.modules&&e.company.modules.group_buy&&!0!==e.company.modules.group_buy.pickup_location&&(!e.pickupLocation||!e.pickupLocation.id)){var c=angular.element("<ask-customer-service-panel title=\"{{'SORRY_THIS_MODULE_IS_NOT_ENABLED' | translate}}\" btn-text=\"{{'CUSTOMER_SERVICE.CLICK_HERE_TO_ENABLE_THIS_MODULE' | translate}}\"></ask-customer-service-panel>");i(c)(e),r.replaceWith(c)}}}};angular.module("shmApp.directives").directive("companyPickupLocationEdit",["appConf","CompanyService","UtilsService","$compile","$rootScope",e])}(),function(){"use strict";var e,t=function(t,n,i,a){e=this,e.company=i,e.pickupLocation=n,e.cancel=function(){t.dismiss("cancel")},e.deletePickupLocation=function(){e.deleting=!0,e.deletingErr=void 0,a.deleteCompanyPickupLocation(e.company.id,e.pickupLocation.id).then(function(e){t.close(e.data&&e.data.success&&!0===e.data.success)},function(t){e.deletingErr=t.data}).finally(function(){e.deleting=void 0})}},n=function(e,n,i,a){return{restrict:"AE",scope:{appUser:"<",company:"<",hideTitle:"<?"},templateUrl:e.rootDir.views+"company/companyPickupLocations.html",link:function(r,o,c){r.getPickupLocations=function(){r.gettingLocations=!0,r.gettingLocationsErr=void 0,n.getCompanyPickupLocations(r.company.id).then(function(e){r.locationList=e.data},function(e){r.gettingLocationsErr=e.data}).finally(function(){r.gettingLocations=void 0})},r.showNewLocationPanel=function(){r.addingNewLocation=!0},r.hideNewLocationPanel=function(){r.addingNewLocation=void 0},r.showEditPanel=function(e){angular.forEach(r.locationList,function(e){e.editing=void 0}),r.locationList&&r.locationList[e]&&(r.locationList[e].editing=!0)},r.hideEditPanel=function(){angular.forEach(r.locationList,function(e){!0===e.editing&&(e.editing=void 0)})},r.confirmDelete=function(n){a.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:e.rootDir.views+"company/confirmDeletePickupLocation.html",controller:["$uibModalInstance","pickupLocation","company","CompanyService",t],controllerAs:"mdCtrl",size:void 0,appendTo:void 0,resolve:{pickupLocation:function(){return r.locationList[n]},company:function(){return r.company}}}).result.then(function(e){!0===e&&(r.locationList[n].active=0)})},r.getPickupLocations(),r.company=i.formatCompany(r.appUser,r.company),r.canCreate=!0===r.company.isCompanyAdmin&&!0!==r.company.is_expired||!0===r.appUser.is_admin}}};angular.module("shmApp.directives").directive("companyPickupLocations",["appConf","CompanyService","UtilsService","$uibModal",n])}(),function(){"use strict";var e=function(e,t,n,i){var a=this;a.appUser=t,a.company=n,a.cancel=function(){e.dismiss("cancel")},a.getQrCodes=function(){a.totalQrCodes=0,a.getting=!0,a.gettingErr=void 0,i.getCompanyQrcodes(a.company.id).then(function(e){a.qrcodes=e.data,angular.forEach(a.qrcodes,function(e,t){e&&null!==e&&""!==e?a.totalQrCodes=1*a.totalQrCodes+1:delete a.qrcodes[t]})},function(e){a.gettingErr=e.data}).finally(function(){a.getting=void 0})},a.getQrCodes()},t=function(t,n){return{restrict:"AE",scope:{appUser:"<",company:"<"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"company/companyQrCodePanel.html",controller:["$uibModalInstance","appUser","company","CompanyService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},company:function(){return i.company}}})})}}};angular.module("shmApp.directives").directive("companyQrCodePopupBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a,r){var o=this;o.appUser=t,o.company=n,o.steps={companyInfoUpdated:void 0,companyEnablePaymentMethods:void 0},o.finishedAllSteps=!1,o.cancel=function(){e.dismiss("cancel")},o.close=function(t){e.close(t)},o.checkAllStepsFinished=function(){return angular.forEach(o.steps,function(e,t){console.log(t)}),o},o.updateCompanyInfo=function(){if(!o.company.name||""===o.company.name)return void(o.savingErr={message:a.instant("COMPANY.NAME.IS_REQUIRED"),errors:{name:[a.instant("COMPANY.NAME.IS_REQUIRED")]}});var e={};return e.company=r.formatCompany(o.appUser,o.company),"object"==typeof o.company.config&&(e.company.config=JSON.stringify(e.company.config)),"object"==typeof o.company.admin_config&&(e.company.admin_config=JSON.stringify(e.company.admin_config)),o.saving=!0,o.savingErr=void 0,i.updateInfo(e.company.id,e.company).then(function(e){o.company=e.data,o.steps.companyInfoUpdated=!0,o.checkAllStepsFinished()},function(e){o.savingErr=e.data}).finally(function(){o.saving=void 0}),o}},t=function(t,n,i,a){return{restrict:"AE",scope:{appUser:"<",company:"<"},link:function(r,o,c){r.appUser&&r.appUser.id&&""!==r.appUser.id&&r.company&&r.company.id&&""!==r.company.id&&!1===r.company.has_been_setup&&(!0===r.company.isCompanyAdmin||!0===r.company.isCurrentUserAdmin)&&i.open({animation:!0,templateUrl:t.rootDir.views+"company/companySetupGuidePanel.html",controller:["$uibModalInstance","appUser","company","CompanyService","$translate","UtilsService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return r.appUser},company:function(){return r.company}}}).result.then(function(e){n.setSelectedCompany(e),n.updateCompanyInAllStoredCompanies(e),a.location.reload()})}}};angular.module("shmApp.directives").directive("companySetupGuidePanel",["appConf","UtilsService","$uibModal","$window",t])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"="},templateUrl:e.rootDir.views+"company/companySuperAdminPanel.html",link:function(e,t,n){e.packageList=[{type:"normal",name:"PACKAGE.SELECTION.NORMAL_PACKAGE"},{type:"recommendation",name:"PACKAGE.SELECTION.RECOMMENDED_PACKAGE"},{type:"professional",name:"PACKAGE.SELECTION.PROFESSIONAL_PACKAGE"},{type:"none",name:"PACKAGE.SELECTION.NONE_PACKAGE"}]}}};angular.module("shmApp.directives").directive("companySuperAdminPanel",["appConf","$translate",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",optionsPosition:"@?"},templateUrl:e.rootDir.views+"company/companySwitch.html",link:function(e,n,r){e.switch=function(e){a.setSelectedCompany(e),i.go("backend.dashboard",{},{reload:!0})},e.getAllCompanies=function(){e.getting=!0,e.gettingErr=void 0,t.getAllCompanies().then(function(t){e.companyOptions=t.data,a.setAllStoredCompanies(e.companyOptions)},function(t){e.gettingErr=t.data}).finally(function(){e.getting=void 0})},e.showCompanyOptions=function(){!0===e.appUser.is_admin&&(e.companyOptions=a.getAllStoredCompanies())},e.searchObject={text:""},e.optionsPosition=e.optionsPosition||"bottom",e.companyOptions=e.appUser.userCompany,!0===e.appUser.is_admin&&(e.companyOptions=a.getAllStoredCompanies(),e.companyOptions&&0!==e.companyOptions.length||e.getAllCompanies())}}};angular.module("shmApp.directives").directive("companySwitch",["appConf","CompanyService","$rootScope","$state","UtilsService","$timeout",e])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"A",scope:{notCompanyAdminPanel:"<",appUser:"<?"},link:function(t,a,r){var o={};t.appUser=t.appUser||e.appUser,t.company=n.formatCompany(t.appUser,t.notCompanyAdminPanel),!0!==t.company.isCurrentUserAdmin&&!0!==e.appUser.is_admin&&(o.html='<div class="not-company-admin-panel-wrapper"><div class="title" translate="ACCESS_DENY"></div><div class="body"><div translate="YOU_ARE_NOT_THE_COMPANY_ADMIN" translate-values="{\'company_name\': company.name}"></div></div></div>',o.newElement=i(o.html)(t),a.replaceWith(o.newElement))}}};angular.module("shmApp.directives").directive("notCompanyAdminPanel",["$rootScope","appConf","UtilsService","$compile",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"dashboard/dashboard.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("dashboard",["appConf","CompanyService",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"groupBuy/groupBuyList.html",link:function(n,i,a){n.getItems=function(i){var a={page:i||1};a.params={"page-size":n.pageSize,page:a.page,"key-word":n.searchObj.text,community_id:e.community.group_buy.id},a.params=angular.merge({},a.params,n.searchTypes[n.searchObj.selected_type]),n.gettingErr=void 0,n.gettingMoreErr=void 0,a.page>1?n.gettingMore=!0:n.getting=!0,t.searchItemsUnderCompanyOnlyForGroupBuy(n.company.id,a.params).then(function(e){n.itemList&&n.itemList.data&&n.itemList.data.length>0&&a.page>1?(a.previousData=n.itemList.data,n.itemList=e.data,n.itemList.data=a.previousData.concat(e.data.data)):n.itemList=e.data},function(e){a.page>1?n.gettingMoreErr=e.data:n.gettingErr=e.data}).finally(function(){n.getting=void 0,n.gettingMore=void 0})},n.switchType=function(e){n.searchObj.selected_type=e,n.getItems()},n.pageSize=n.pageSize?n.pageSize:12,n.searchTypes={available:{is_draft:0,is_ended:0,is_expired:0,is_published:1,is_sold:0},ended:{is_expired:1,is_draft:0},all:{}},n.searchObj={text:"",selected_type:Object.keys(n.searchTypes)[0]},n.getItems()}}};angular.module("shmApp.directives").directive("groupBuyList",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<"},templateUrl:e.rootDir.views+"groupBuy/groupBuyListItem.html",link:function(e,t,n){e.item.title=e.item.title.replace(" ","")}}};angular.module("shmApp.directives").directive("groupBuyListItem",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",itemId:"<",company:"<",cancelFunc:"&?"},templateUrl:e.rootDir.views+"groupBuy/groupBuyDetails.html",link:function(e,i,a){e.getGroupBuyItemDetails=function(){e.loadingDetails=!0,e.loadingDetailsErr=void 0,t.getItemDetails(e.itemId).then(function(t){e.itemDetails=t.data,e.itemDetails.date_expiry=moment(moment.utc(e.itemDetails.date_expiry)).local().format("YYYY-MM-DD HH:mm:ss"),n.editingGroupbuy=e.itemDetails},function(t){e.loadingDetailsErr=t.data}).finally(function(){e.loadingDetails=void 0})},e.cancel=function(){!0===e.hasCancelFunc&&e.cancelFunc()()},e.itemSaved=function(e){r.go("backend.group_buys_details",{id:e.id},{reload:!0})},e.startDateBeforeRender=function(e){var t=new Date,n=new Date(t);n.setDate(t.getDate()+1),n.setUTCHours(0,0,0,0),e.filter(function(e){return e.utcDateValue<n.getTime()}).forEach(function(e){e.selectable=!1})},e.deleteBonus=function(t){switch(t){case e.bonusTypeList.participate:e.itemDetails.jielong_success_entities=[];break;case e.bonusTypeList.share:e.itemDetails.wxshare_success_entities=[]}},e.itemId?e.getGroupBuyItemDetails():e.itemDetails={},e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin,e.hasCancelFunc="function"==typeof e.cancelFunc&&"function"==typeof e.cancelFunc(),e.hasExpireDate=!1,e.bonusTypeList={share:{name:"SHARE"},participate:{name:"PARTICIPATE"}},e.jielongVoucherEntityMap={voucher_group:"App\\Modules\\Platform\\Models\\CompanyVoucherGroup",voucher_campaign:"App\\Modules\\Platform\\Models\\VoucherCampaign"}}}};angular.module("shmApp.directives").directive("groupBuyDetails",["appConf","ItemService","$rootScope","$uibModal","$translate","$state",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){var o=this;o.appUser=t,o.company=n,o.selectedEntities=angular.copy(i),o.bonusType=a,o.cancel=function(){e.dismiss("cancel")},o.add=function(){void 0==o.selectedEntities[0]&&(o.selectedEntities=[]),e.close(o.selectedEntities)},o.getVoucherList=function(e){var t={page:e||1};t.params={"page-size":12,page:t.page,available:1},o.searchObject&&o.searchObject.text&&""!=o.searchObject.text&&(t.params["key-word"]=o.searchObject.text),o._getVoucherList(e,t.params)},o._getVoucherList=function(e,t){var n={page:e};o.gettingErr=void 0,o.gettingMoreErr=void 0,n.page>1?o.gettingMore=!0:o.getting=!0,r.getVoucherGroupsUnderCompany(o.company.id,t).then(function(e){o.itemList&&o.itemList.data&&o.itemList.data.length>0&&n.page>1?(n.previousData=o.itemList.data,o.itemList=e.data,o.itemList.data=n.previousData.concat(e.data.data)):o.itemList=e.data},function(e){n.page>1?o.gettingMoreErr=e.data:o.gettingErr=e.data}).finally(function(){o.getting=void 0,o.gettingMore=void 0})},o.jielongVoucherEntityMap={voucher_group:"App\\Modules\\Platform\\Models\\CompanyVoucherGroup",voucher_campaign:"App\\Modules\\Platform\\Models\\VoucherCampaign"},o.getVoucherList()},t=function(t,n){return{restrict:"AE",scope:{appUser:"<",company:"<",selectedEntities:"=?",bonusType:"=?"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"groupBuy/groupBuyVoucherSelector.html",controller:["$uibModalInstance","appUser","company","selectedEntities","bonusType","CompanyService",e],controllerAs:"mdCtrl",size:"lg",resolve:{appUser:function(){return i.appUser},company:function(){return i.company},selectedEntities:function(){return i.selectedEntities},bonusType:function(){return i.bonusType}}}).result.then(function(e){i.selectedEntities=e})})}}};angular.module("shmApp.directives").directive("groupBuyVoucherSelector",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{appUser:"<",bonusEntities:"=?",bonusType:"<?",company:"<?"},templateUrl:e.rootDir.views+"groupBuy/groupBuyVoucherPreview.html",link:function(e,t,n){e.deleteBonus=function(){e.bonusEntities=[]}}}};angular.module("shmApp.directives").directive("groupBuyVoucherPreview",["appConf",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"event/eventList.html",link:function(n,i,a){n.getItems=function(i){var a={page:i||1};a.params={"page-size":n.pageSize,page:a.page,"key-word":n.searchObj.text,community_id:e.community.group_buy.id},a.params=angular.merge({},a.params,n.searchTypes[n.searchObj.selected_type]),n.gettingErr=void 0,n.gettingMoreErr=void 0,a.page>1?n.gettingMore=!0:n.getting=!0,t.searchItemsUnderCompanyOnlyForGroupBuy(n.company.id,a.params).then(function(e){n.itemList&&n.itemList.data&&n.itemList.data.length>0&&a.page>1?(a.previousData=n.itemList.data,n.itemList=e.data,n.itemList.data=a.previousData.concat(e.data.data)):n.itemList=e.data},function(e){a.page>1?n.gettingMoreErr=e.data:n.gettingErr=e.data}).finally(function(){n.getting=void 0,n.gettingMore=void 0})},n.switchType=function(e){n.searchObj.selected_type=e,n.getItems()},n.pageSize=n.pageSize?n.pageSize:12,n.searchTypes={available:{is_draft:0,is_ended:0,is_expired:0,is_published:1,is_sold:0},ended:{is_expired:1,is_draft:0},all:{}},n.searchObj={text:"",selected_type:Object.keys(n.searchTypes)[0]},n.getItems()}}};angular.module("shmApp.directives").directive("eventList",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<"},templateUrl:e.rootDir.views+"event/eventListItem.html",link:function(e,t,n){e.item.title=e.item.title.replace(" ","")}}};angular.module("shmApp.directives").directive("eventListItem",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",itemId:"<",company:"<",cancelFunc:"&?"},templateUrl:e.rootDir.views+"event/eventDetails.html",link:function(e,i,a){e.getDetails=function(){e.loadingDetails=!0,e.loadingDetailsErr=void 0,t.getItemDetails(e.itemId).then(function(t){e.itemDetails=t.data,e.itemDetails.date_expiry=moment(moment.utc(e.itemDetails.date_expiry)).local().format("YYYY-MM-DD HH:mm:ss"),n.editingEvent=e.itemDetails},function(t){e.loadingDetailsErr=t.data}).finally(function(){e.loadingDetails=void 0})},e.cancel=function(){console.log(e.itemDetails)},e.itemSaved=function(e){r.go("backend.events_details",{id:e.id},{reload:!0})},e.startDateBeforeRender=function(e){var t=new Date,n=new Date(t);n.setDate(t.getDate()+1),n.setUTCHours(0,0,0,0),e.filter(function(e){return e.utcDateValue<n.getTime()}).forEach(function(e){e.selectable=!1})},e.itemId?e.getDetails():e.itemDetails={},e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin,e.hasCancelFunc="function"==typeof e.cancelFunc&&"function"==typeof e.cancelFunc(),e.hasExpireDate=!1}}};angular.module("shmApp.directives").directive("eventDetails",["appConf","ItemService","$rootScope","$uibModal","$translate","$state",e])}(),function(){"use strict";var e=function(e,t,n,i){var a=this;a.appUser=t,a.item=n,a.cancel=function(){e.dismiss("cancel")},a.sendEmail=function(){var t={email:a.receiver};i.genJielongReportEmail(a.item.id,t).then(function(t){e.close(t.data)},function(e){a.gettingErr=e.data}).finally(function(){a.getting=void 0})}},t=function(t,n,i,a){return{restrict:"AE",scope:{appUser:"<",item:"=?"},link:function(r,o,c){o.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"event/eventRecordsExporter.html",controller:["$uibModalInstance","appUser","item","ItemService",e],controllerAs:"mdCtrl",size:"lg",resolve:{appUser:function(){return r.appUser},item:function(){return r.item}}}).result.then(function(e){e.success&&i.success(a.instant("EVENTS.EXPORT.RECORDS.SUCCESS"))})})}}};angular.module("shmApp.directives").directive("eventRecordsExporter",["appConf","$uibModal","toastr","$translate",t])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{appUser:"<",config:"=ngModel"},templateUrl:e.rootDir.views+"event/inputForm.html",link:function(e,t,n){e.addNewInput=function(){e.inputs.push({title:null,type:null}),e.config=JSON.stringify(e.configs)},e.removeInput=function(t){console.log(e.config)},e.configs=JSON.parse(e.config),e.inputs=e.configs.inputFields,e.config=JSON.stringify(e.configs)}}};angular.module("shmApp.directives").directive("inputForm",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i,a){var r=this;r.items=t.items,r.asset=t,r.cancel=function(){e.dismiss("cancel")},r.yes=function(){e.dismiss("cancel"),a(t.index,t.id)}},t=function(t,n){return{restrict:"AE",scope:{asset:"<",assetsData:"=",deleteFunc:"&"},link:function(i,a,r){i.deleteAsset=function(){console.log("deleting...")},a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"media/itemListOfCertainAsset.html",controller:["$uibModalInstance","asset","assetsData","AssetService","deleteFunc",e],controllerAs:"mdCtrl",resolve:{asset:function(){return i.asset},assetsData:function(){return i.assetsData},deleteFunc:function(){return i.deleteFunc()}}})})}}};angular.module("shmApp.directives").directive("itemListOfCertainAssetBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t){var n=this;n.asset=t,n.cancel=function(){e.dismiss("cancel")}},t=function(t,n){return{restrict:"AE",scope:{asset:"<"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"media/showRealityOfAsset.html",controller:["$uibModalInstance","asset",e],controllerAs:"mdCtrl",resolve:{asset:function(){return i.asset}}})})}}};angular.module("shmApp.directives").directive("showRealityOfAsset",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a){var r=this;r.appUser=t,r.item=n,r.itemType=i,r.cancel=function(){e.dismiss("cancel")},r.delete=function(){r.deleting=!0,r.deletingErr=void 0,a.markItemDeactivate(r.item.id).then(function(t){e.close(t.data)},function(e){r.deletingErr=e.data}).finally(function(){r.deleting=void 0})}},t=function(t,n,i){return{restrict:"A",scope:{appUser:"<",itemDeleteBtn:"=",succFunc:"&?",itemType:"@?"},link:function(a,r,o){r.on("click",function(){i.open({animation:!0,templateUrl:t.rootDir.views+"item/confirmDelete.html",controller:["$uibModalInstance","appUser","item","itemType","ItemService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return a.appUser},item:function(){return a.itemDeleteBtn},itemType:function(){return a.itemType}}}).result.then(function(e){a.item=n.formatItem(e),"function"==typeof a.succFunc&&"function"==typeof a.succFunc()&&a.succFunc()(a.item)})})}}};angular.module("shmApp.directives").directive("itemDeleteBtn",["appConf","UtilsService","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a){var r=this;r.appUser=t,r.item=n,r.itemType=i,r.cancel=function(){e.dismiss("cancel")},r.save=function(){r.saving=!0,r.savingErr=void 0,a.markItemEnd(r.item.id).then(function(t){e.close(t.data)},function(e){r.savingErr=e.data}).finally(function(){r.saving=void 0})}},t=function(t,n,i){return{restrict:"A",scope:{appUser:"<",itemEndBtn:"=",succFunc:"&?",itemType:"@?"},link:function(a,r,o){r.on("click",function(){i.open({animation:!0,templateUrl:t.rootDir.views+"item/confirmEnd.html",
controller:["$uibModalInstance","appUser","item","itemType","ItemService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return a.appUser},item:function(){return a.itemEndBtn},itemType:function(){return a.itemType}}}).result.then(function(e){a.item=n.formatItem(e),"function"==typeof a.succFunc&&"function"==typeof a.succFunc()&&a.succFunc()(a.item)})})}}};angular.module("shmApp.directives").directive("itemEndBtn",["appConf","UtilsService","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n){return{restrict:"AE",scope:{appUser:"<",item:"=",succFunc:"&?",itemType:"@?"},templateUrl:e.rootDir.views+"item/optionBtns.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("itemOptionBtns",["appConf","UtilsService","$uibModal",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){var o=this;o.appUser=t,o.item=n,o.itemType=i,o.cancel=function(){e.dismiss("cancel")},o.save=function(){o.item.is_draft=!1,o.item.is_sync_to_market=!o.item.is_draft,o.item.date_publish=r.getNowUtcDateTime().format("YYYY-MM-DD HH:m:ss"),"object"==typeof o.item.config&&(o.item.config=JSON.stringify(o.item.config)),o.saving=!0,o.savingErr=void 0,a.updateItem(o.item.id,o.item).then(function(t){e.close(t.data)},function(e){o.savingErr=e.data}).finally(function(){o.saving=void 0})}},t=function(t,n,i){return{restrict:"A",scope:{appUser:"<",itemPublishBtn:"=",succFunc:"&?",itemType:"@?"},link:function(a,r,o){r.on("click",function(){i.open({animation:!0,templateUrl:t.rootDir.views+"item/confirmPublish.html",controller:["$uibModalInstance","appUser","item","itemType","ItemService","UtilsService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return a.appUser},item:function(){return a.itemPublishBtn},itemType:function(){return a.itemType}}}).result.then(function(e){a.item=n.formatItem(e),"function"==typeof a.succFunc&&"function"==typeof a.succFunc()&&a.succFunc()(a.item)})})}}};angular.module("shmApp.directives").directive("itemPublishBtn",["appConf","UtilsService","$uibModal",t])}(),function(){"use strict";var e=function(e){return{restrict:"A",scope:{itemQrCodePanel:"<",title:"@?"},template:'<div class="item-qr-codes-wrapper"><loading-bar ng-if="getting === true"></loading-bar><div ng-if="getting !== true" class="text-center"><show-error-from-json error-obj="gettingErr"></show-error-from-json><div translate="ITEM.PREVIEW.QRCODE.BODY" ng-if="!title"></div><h3 ng-if="title" ng-bind-html="title"></h3><div class="item-qrcodes-list qrcode-list text-center row" ng-if="!gettingErr"><div class="qrcode-list-item {{key}} text-center ngClass:{\'col-md-12\': totalQrCodes <= 1, \'col-md-6\': totalQrCodes > 1}" ng-repeat="(key, url) in qrcodes"><img ng-src="{{url}}" class="img-responsive qrcode-img"/></div></div></div></div>',link:function(t,n,i){t.getQrCodes=function(){t.totalQrCodes=0,t.getting=!0,t.gettingErr=void 0,e.getItemQrCodes(t.item.id).then(function(e){t.qrcodes=e.data,angular.forEach(t.qrcodes,function(e,n){e&&null!==e&&""!==e?t.totalQrCodes=1*t.totalQrCodes+1:delete t.qrcodes[n]})},function(e){t.gettingErr=e.data}).finally(function(){t.getting=void 0})},t.item=t.itemQrCodePanel,t.getQrCodes()}}};angular.module("shmApp.directives").directive("itemQrCodePanel",["ItemService",e])}(),function(){"use strict";var e=function(e,t){var n=this;n.item=t,n.cancel=function(){e.dismiss("cancel")}},t=function(t){return{restrict:"A",scope:{itemQrCodePopupBtn:"<"},link:function(n,i){i.on("click",function(){t.open({animation:!0,template:'<div class="item-qrcodes-wrapper"><div class="modal-header"><div class="modal-title" translate="ITEM.PREVIEW.QRCODE.TITLE"></div></div><div class="modal-body"><div item-qr-code-panel="mdCtrl.item"></div></div><div class="modal-footer text-center"><button type="button" class="btn btn-success" translate="OK" ng-click="mdCtrl.cancel()"></button></div></div>',controller:["$uibModalInstance","item",e],controllerAs:"mdCtrl",resolve:{item:function(){return n.itemQrCodePopupBtn}}})})}}};angular.module("shmApp.directives").directive("itemQrCodePopupBtn",["$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a,r,o,c,s,u){var p=this;p.appUser=n,p.item=i,p.itemType=o,p.company=r,p.preCheckingErr=a,p.cancel=function(){t.dismiss("cancel")},p.close=function(){t.close(p.item)},p.save=function(t){var n={};p.item.is_draft=t||!1,p.item.is_sync_to_market=!p.item.is_draft,p.item.multi_participations=!1,p.item.date_expiry&&null!=p.item.date_expiry?p.item.date_expiry=moment(p.item.date_expiry).format("YYYY-MM-DD HH:mm:ss"):(n.maxUtcDateTime=u.getMaxUtcDateTime(),p.item.date_expiry=n.maxUtcDateTime.format("YYYY-MM-DD HH:mm:ss")),p.item.date_publish=u.getNowUtcDateTime().format("YYYY-MM-DD HH:mm:ss"),p.item.address||(p.item.address=u.getDefaultAddressObj()),p.item.tagNames&&0!=p.item.tagNames.length||(p.item.tagNames=[e.community[c].name]),p.item.id&&""!=p.item.id||(p.item.company_id=p.company.id),"object"==typeof p.item.config&&(p.item.config=JSON.stringify(p.item.config)),n.savingFunc=p.item.id&&""!==p.item.id?s.updateItem(p.item.id,p.item):s.createItem(p.item),p.saving=!0,p.savingErr=void 0,p.savingSuccess=void 0,n.savingFunc.then(function(e){p.item=u.formatItem(e.data),p.savingSuccess=!0},function(e){p.savingErr=e.data}).finally(function(){p.saving=void 0})}},t=function(t,n,i,a,r){return{restrict:"A",scope:{appUser:"<",company:"<",communityType:"@",itemSaveBtn:"=",succFunc:"&?",itemType:"@?",getPreCheckErrFunc:"&?"},link:function(o,c,s){o.item=o.itemSaveBtn,c.on("click",function(){i.open({animation:!0,templateUrl:t.rootDir.views+"item/confirmSave.html",controller:["appConf","$uibModalInstance","appUser","item","preCheckingErr","company","itemType","communityType","ItemService","UtilsService",e],controllerAs:"mdCtrl",backdrop:"static",keyboard:!1,resolve:{appUser:function(){return o.appUser},item:function(){return o.item},company:function(){return o.company},itemType:function(){return o.itemType},communityType:function(){return o.communityType},preCheckingErr:function(){if("function"==typeof o.getPreCheckErrFunc&&"function"==typeof o.getPreCheckErrFunc())return o.getPreCheckErrFunc()(o.item)}}}).result.then(function(e){o.item.id&&""!==o.item.id?a.success(r.instant("ITEM.UPDATE.SUCCESSFULLY")):a.success(r.instant("ITEM.CREATE.SUCCESSFULLY")),o.item=n.formatItem(e),"function"==typeof o.succFunc&&"function"==typeof o.succFunc()&&o.succFunc()(o.item)})})}}};angular.module("shmApp.directives").directive("itemSaveBtn",["appConf","UtilsService","$uibModal","toastr","$translate",t])}(),function(){"use strict";var e=function(e){return{restrict:"A",scope:{showItemWithStatus:"<"},link:function(t,n,i){t.item=t.showItemWithStatus,n.addClass("item-with-status"),n.addClass("item-with-status-"+e.getItemStatusName(t.item).toLowerCase())}}};angular.module("shmApp.directives").directive("showItemWithStatus",["ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i,a){return{restrict:"AE",scope:{appUser:"<?"},templateUrl:e.rootDir.views+"language/languageSwitch.html",link:function(e,n,r){e.toggleDisplayOptions=function(){e.displayOptions=!0!==e.displayOptions},e.hideOptions=function(){e.displayOptions=!1},e.switch=function(t){a.switchLanguage(t),e.selectedLanguage=t,e.hideOptions()},e.selectedLanguage=t.use(),e.languages=a.getSupportedLanguages(),i.search().lang&&""!==i.search().lang?e.switch(i.search().lang):""!==a.getLocalLanguageKey()&&e.switch(a.getLocalLanguageKey())}}};angular.module("shmApp.directives").directive("languageSwitch",["appConf","$translate","amMoment","$location","LanguageService",e])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"AE",scope:{appUser:"<?"},templateUrl:e.rootDir.views+"login/loginPanel.html",link:function(e,a,r){e.getCurrentUser=function(){e.gettingCurrentUser=!0,e.gettingCurrentUserErr=void 0,n.getMe().then(function(n){if(n.data&&n.data.id){t.appUser=e.appUser=n.data;var a=i.getSelectedCompany();a&&a.id||(a=t.appUser.userCompany[0]),i.setSelectedCompany(a)}},function(t){e.gettingCurrentUserErr=void 0}).finally(function(){e.gettingCurrentUser=!1})},e.appUser={},e.getCurrentUser()}}};angular.module("shmApp.directives").directive("loginPanel",["appConf","$rootScope","AuthService","UtilsService",e])}(),function(){"use strict";var e=function(e,t,n,i,a){return{restrict:"AE",scope:{},templateUrl:e.rootDir.views+"login/weChatLoginQrPanel.html",link:function(e,r,o){e.navToDashboard=function(){t.go("backend.dashboard",{},{reload:!0})},e.loginWithToken=function(t){e.loggedIn=void 0,e.loggingIn=!0,e.loggingInErr=void 0,n.loginWithTempCode(t).then(function(t){t.data&&t.data.return_code&&(a.cancel(e.loginStatusChecker),i.setToken(t.data.return_code),e.loggedIn=!0,e.navToDashboard())},function(t){e.loggingInErr=t.data}).finally(function(){e.loggingIn=void 0})},e.getLoginStatus=function(){e.gotLoginStatus=void 0,e.gettingLoginStatus=!0,e.gettingLoginStatusErr=void 0,n.checkLoginStatus(e.loginObj.subscribeLoginLogId).then(function(t){t.data&&t.data.log&&t.data.log.tmp_token&&""!==t.data.log.tmp_token&&(a.cancel(e.loginStatusChecker),e.gotLoginStatus=!0,e.loginWithToken(t.data.log.tmp_token))},function(t){e.gettingLoginStatusErr=t.data}).finally(function(){e.gettingLoginStatus=void 0})},e.startGetLoginStatus=function(){e.loginStatusCheckerTimes=0,e.loginStatusChecker=a(function(){e.getLoginStatus(),e.loginStatusCheckerTimes+=1,e.loginStatusCheckerTimes>e.loginStatusCheckerMaxTimes&&a.cancel(e.loginStatusChecker)},e.loginStatusCheckerInterval)},e.getQrCodeUrl=function(){return e.loadingWechatLoginUrl=!0,e.loadingWechatLoginUrlErr=void 0,n.generateLoginQrCode().then(function(t){e.loginObj=t.data,e.startGetLoginStatus()},function(t){e.loadingWechatLoginUrlErr=t.data}).finally(function(){e.loadingWechatLoginUrl=!1}),e},e.getQrCodeUrl(),e.loginStatusCheckerTimes=0,e.loginStatusCheckerMaxTimes=5e3,e.loginStatusCheckerInterval=1e3}}};angular.module("shmApp.directives").directive("weChatLoginQrPanel",["appConf","$state","AuthService","$auth","$interval",e])}(),function(){"use strict";var e,t,n,i=function(i,a,r){return e=i,t=a,n=r,{restrict:"AE",scope:{},template:"<loading-bar></loading-bar>",link:function(i){e.setToken(t.params.token),t.params.origurl?n.location.href=decodeURIComponent(t.params.origurl):t.go("backend.dashboard",{},{reload:!0})}}};angular.module("shmApp.directives").directive("loginFromToken",["$auth","$state","$window",i])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"note/noteList.html",link:function(n,i,a){n.switchType=function(e){n.searchObj.selected_type=e,n.getItems()},n.getItems=function(i){var a={page:i||1};a.params={"page-size":n.pageSize,page:a.page,"key-word":n.searchObj.text,community_id:e.community.note.id},a.params=angular.merge({},a.params,n.searchTypes[n.searchObj.selected_type]),n.gettingErr=void 0,n.gettingMoreErr=void 0,a.page>1?n.gettingMore=!0:n.getting=!0,t.searchItemsUnderCompany(n.company.id,a.params).then(function(e){n.itemList&&n.itemList.data&&n.itemList.data.length>0&&a.page>1?(a.previousData=n.itemList.data,n.itemList=e.data,n.itemList.data=a.previousData.concat(e.data.data)):n.itemList=e.data},function(e){a.page>1?n.gettingMoreErr=e.data:n.gettingErr=e.data}).finally(function(){n.getting=void 0,n.gettingMore=void 0})},n.pageSize=n.pageSize?n.pageSize:12,n.searchTypes={published:{is_published:1,is_draft:0,is_ended:0},draft:{is_published:0,is_draft:1},ended:{is_published:0,is_ended:1},all:{}},n.searchObj={text:"",selected_type:Object.keys(n.searchTypes)[0]},n.getItems()}}};angular.module("shmApp.directives").directive("noteList",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<"},templateUrl:e.rootDir.views+"note/noteGridItem.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("noteGridItem",["appConf","UtilsService",e])}(),function(){"use strict";var e,t=function(t){return e=t,{restrict:"AE",scope:{errorObj:"<"},templateUrl:t.rootDir.views+"note/alterMediaSizeExceed.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("alterMediaSizeExceed",["appConf",t])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"product/productList.html",link:function(n,i,a){n.getItems=function(i){var a={page:i||1};a.params={"page-size":n.pageSize,page:a.page,"key-word":n.searchObj.text,community_id:e.community.note.id},a.params=angular.merge({},a.params,n.searchTypes[n.searchObj.selected_type]),n.gettingErr=void 0,n.gettingMoreErr=void 0,a.page>1?n.gettingMore=!0:n.getting=!0,t.searchItemsUnderCompanyOnlyForProduct(n.company.id,a.params).then(function(e){n.itemList&&n.itemList.data&&n.itemList.data.length>0&&a.page>1?(a.previousData=n.itemList.data,n.itemList=e.data,n.itemList.data=a.previousData.concat(e.data.data)):n.itemList=e.data},function(e){a.page>1?n.gettingMoreErr=e.data:n.gettingErr=e.data}).finally(function(){n.getting=void 0,n.gettingMore=void 0})},n.switchType=function(e){n.searchObj.selected_type=e,n.getItems()},n.pageSize=n.pageSize?n.pageSize:12,n.searchTypes={selling:{is_draft:0,is_expired:0,is_sold:0},sold:{is_sold:1},expired:{is_expired:1,is_sold:0,is_draft:0},draft:{is_draft:1},all:{}},n.searchObj={text:"",selected_type:Object.keys(n.searchTypes)[0]},n.getItems()}}};angular.module("shmApp.directives").directive("productList",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<"},templateUrl:e.rootDir.views+"product/productGridItem.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("productGridItem",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",company:"<",item:"=?",cancelFunc:"&?",itemLoadedFunc:"&?",succFunc:"&?"},templateUrl:e.rootDir.views+"product/productDetails.html",link:function(e,i,o){e.getItemDetails=function(i){e.gettingDetails=!0,e.gettingDetailsErr=void 0,t.getItemDetails(e.item.id).then(function(t){e.item=n.formatItem(t.data),"function"==typeof i&&i(e.item)},function(t){e.gettingDetailsErr=t.data}).finally(function(){e.gettingDetails=void 0})},e.cancel=function(){!0===e.hasCancelFunc&&e.cancelFunc()()},e.itemSaved=function(e){a.go("backend.product_details",{id:e.id},{reload:!0})},e.preSaveCheck=function(e){return e.title&&""!==e.title?e.price&&""!==e.price?void 0:n.getErrorMsgObj(r.instant("PRODUCT.PRICE.IS_REQUIRED")):n.getErrorMsgObj(r.instant("PRODUCT.TITLE.IS_REQUIRED"))},e.hasCancelFunc="function"==typeof e.cancelFunc&&"function"==typeof e.cancelFunc(),e.item=e.item||{images:[],config:{}},e.isSameCompany=!1,e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin,e.item.id&&""!==e.item.id&&e.getItemDetails(function(t){e.canEdit=0!==parseInt(e.item.active)&&!0===e.canEdit,"function"==typeof e.itemLoadedFunc&&"function"==typeof e.itemLoadedFunc()&&e.itemLoadedFunc()(t)})}}};angular.module("shmApp.directives").directive("productDetails",["appConf","ItemService","UtilsService","$rootScope","$state","$translate",e])}(),function(){"use strict";var e=function(e,t,n){return{restrict:"AE",scope:{appUser:"<",item:"=",company:"<",formObj:"="},templateUrl:e.rootDir.views+"product/jielongDetailList.html",link:function(e,i,a){e.addMoreProduct=function(){var t={images:[]};e.item.children.push(t)},e.delete=function(t){e.item.children.splice(t,1)},e.getItemPropertiesTypes=function(){t.getPropertyTypes().then(function(t){e.propertyTypes=t.data},function(t){e.errLoadingPropertyTypes=t.data})},e.getCompanyLocations=function(){n.getCompanyPickupLocations(e.company.id).then(function(t){e.locations=t.data,e.ifSelectLocations=!1})},e.selectAllLocations=function(t,n){e.item.children[t].locations=n?e.locations:[]},e.item.id||(e.item.children=[{images:[]}]),e.canEdit=!0===e.company.isCompanyAdmin||!0===e.appUser.is_admin,e.getItemPropertiesTypes(),e.getCompanyLocations()}}};angular.module("shmApp.directives").directive("jielongDetailList",["appConf","ItemService","CompanyService",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<?",succFunc:"&?"},templateUrl:e.rootDir.views+"signUp/signUpPanel.html",link:function(e,o,c){e.loginWithToken=function(t){e.loggingIn=!0,e.loggingInErr=void 0,i.loginWithTempCode(t).then(function(t){t.data&&t.data.return_code&&(n.cancel(e.applicationChecker),a.setToken(t.data.return_code),r.go("backend.dashboard",{},{reload:!0}))},function(t){e.loggingInErr=t.data}).finally(function(){e.loggingIn=void 0})},e.getApplicationStatus=function(){e.gettingApplicationStatus=!0,e.gettingApplicationStatusErr=void 0,t.checkApplicationStatus(e.application.applicationId).then(function(t){t.data&&t.data.shortToken&&""!==t.data.shortToken&&(n.cancel(e.applicationChecker),e.loginWithToken(t.data.shortToken))},function(t){e.gettingApplicationStatusErr=t.data}).finally(function(){e.gettingApplicationStatus=void 0})},e.startGetApplicationStatus=function(){e.applicationCheckerTimes=0,e.applicationChecker=n(function(){e.getApplicationStatus(),e.applicationCheckerTimes+=1,e.applicationCheckerTimes>e.applicationCheckerMaxTimes&&n.cancel(e.applicationChecker)},1e3)},e.preApplyCheck=function(){var n={};n.params=e.newCompany,e.preChecking=!0,e.preCheckingErr=void 0,t.applyCompany(n.params).then(function(t){e.applying=!0,e.application=t.data,e.startGetApplicationStatus()},function(t){e.preCheckingErr=t.data}).finally(function(){e.preChecking=void 0})},e.cancelPreApplyCheck=function(){e.applying=void 0},e.createACompany=function(){e.submitting=!0,e.submittingErr=void 0,t.applyCompany(e.newCompany).then(function(t){"function"==typeof e.succFunc&&"function"==typeof e.succFunc()&&e.succFunc()(t.data)},function(t){e.submittingErr=t.data}).finally(function(){e.submitting=void 0})},e.newCompany={},e.applicationCheckerTimes=0,e.applicationCheckerMaxTimes=5e3}}};angular.module("shmApp.directives").directive("signUpPanel",["appConf","CompanyService","$interval","AuthService","$auth","$state",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<"},templateUrl:e.rootDir.views+"comment/itemCommentList.html",link:function(e,n,i){e.getCommentsForAnItem=function(n){var i={};i.pageNo=n||1,e.gettingItemCommentsErr=void 0,e.gettingMoreItemCommentsErr=void 0,1===i.pageNo?e.gettingItemComments=!0:e.gettingMoreItemComments=!0,t.getCommentsForAnItem(e.item.id).then(function(t){1!==i.pageNo&&(i.previousData=e.itemCommentsList.data),e.itemCommentsList=t.data,1!==i.pageNo&&(e.itemCommentsList.data=i.previousData.concat(e.itemCommentsList.data))},function(t){1===i.pageNo?e.gettingItemCommentsErr=t.data:e.gettingMoreItemCommentsErr=t.data}).finally(function(){e.gettingItemComments=!1,e.gettingMoreItemComments=!1})},e.getCommentsForAnItem()}}};angular.module("shmApp.directives").directive("itemCommentList",["appConf","ItemService",e])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:e.rootDir.views+"staff/staffList.html",link:function(e,a,r){e.searchObject={text:""},e.getItems=function(i){var a={page:i||1};a.params={"page-size":e.pageSize,page:a.page},e.gettingErr=void 0,e.gettingMoreErr=void 0,a.page>1?e.gettingMore=!0:e.getting=!0,t.getUserList(e.company.id,a.params).then(function(t){e.itemList&&e.itemList.data&&e.itemList.data.length>0&&a.page>1?(a.previousData=e.itemList.data,e.itemList.data=t.data.list,e.itemList.data=a.previousData.concat(e.itemList.data)):e.itemList={data:t.data.list,total:t.data.list.length},n.displayCounts=e.itemList.total},function(t){a.page>1?e.gettingMoreErr=t.data:e.gettingErr=t.data}).finally(function(){e.getting=void 0,e.gettingMore=void 0})},e.company=i.formatCompany(e.appUser,e.company),!0!==e.company.isCurrentUserAdmin&&!0!==e.appUser.is_admin||e.getItems()}}};angular.module("shmApp.directives").directive("staffList",["appConf","CompanyService","$rootScope","UtilsService",e])}(),function(){"use strict";var e,t=function(t,n,i,a){e=this,e.staff=n,e.company=i,e.cancel=function(){t.dismiss("cancel")},e.removeUserFromCompany=function(){e.removingUserFromCompany=!0,e.removingUserFromCompanyErr=void 0,a.deleteCompanyUser(e.company.id,e.staff.user.id).then(function(e){t.close(e.data&&e.data.success&&!0===e.data.success)},function(t){e.removingUserFromCompanyErr=t.data}).finally(function(){e.removingUserFromCompany=void 0})}},n=function(e,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",company:"<",staff:"="},templateUrl:e.rootDir.views+"staff/staffListItem.html",link:function(o,c,s){o.changeRole=function(e){!0===o.canChange&&(o.savingStaff=!0,o.savingStaffErr=void 0,n.updateCompanyUser(o.company.id,o.staff.user.id,{is_admin:e}).then(function(t){!0===t.data.success&&(o.staff.role_id=e)},function(e){alert(e.data),o.savingStaffErr=e.data}).finally(function(){o.savingStaff=void 0}))},o.removePending=function(){!0===o.canChange&&!0===o.staff.pending&&(o.savingStaff=!0,o.savingStaffErr=void 0,n.approveCompanyStaff(o.company.id,{user_id:o.staff.user.id}).then(function(e){e.data.id&&e.data.id===o.staff.id&&(o.staff.pending=!1)},function(e){alert(e.data),o.savingStaffErr=e.data}).finally(function(){o.savingStaff=void 0}))},o.confirmRemoveUserFromCompany=function(){i.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:e.rootDir.views+"staff/confirmRemoveUserFromCompany.html",controller:["$uibModalInstance","staff","company","CompanyService",t],controllerAs:"mdCtrl",size:void 0,appendTo:void 0,resolve:{staff:function(){return o.staff},company:function(){return o.company}}}).result.then(function(e){!0===e&&(o.staff.active=0)})},o.company=a.formatCompany(r.appUser,o.company),o.canChange=(!0===o.company.isCompanyAdmin||!0===r.appUser.is_admin)&&r.appUser.id!==o.staff.user.id}}};angular.module("shmApp.directives").directive("staffListItem",["appConf","CompanyService","$uibModal","UtilsService","$rootScope",n])}(),function(){"use strict";var e,t=function(t,n,i,a,r,o){e=this,e.staff=n,e.company=i,e.genQRCode=function(){e.generatingImg=!0,e.generatingImgErr=void 0,a.genAddUserQRCode(e.company.id).then(function(t){e.qrCodeUrl=t.data},function(t){e.generatingImgErr=t.data}).finally(function(){e.generatingImg=!1})},e.getStaffList=function(){a.getUserList(e.company.id).then(function(t){e.staffList=t.data,e.upperLimit=!(!e.staffList.upper_user_limit||!0!==e.staffList.upper_user_limit)},function(t){e.gettingErr=t.data}).finally(function(){e.getting=void 0})},e.cancel=function(){t.dismiss("cancel")},e.getStaffList(),e.company=o.formatCompany(r.appUser,e.company),e.canAdd=(!0===e.company.isCompanyAdmin||!0===r.appUser.is_admin)&&!1===e.upperLimit,!0===e.canAdd&&e.genQRCode()},n=function(e,n){return{restrict:"A",scope:{appUser:"<",company:"<"},link:function(i,a,r){a.on("click",function(){console.log("in:",i.company),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:e.rootDir.views+"staff/staffDetailsEdit.html",controller:["$uibModalInstance","staff","company","CompanyService","$rootScope","UtilsService",t],controllerAs:"mdCtrl",size:void 0,appendTo:void 0,resolve:{staff:function(){return i.staff},company:function(){return i.company}}})})}}};angular.module("shmApp.directives").directive("staffListNewItemBtn",["appConf","$uibModal",n])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",company:"<",pageSize:"<?"},templateUrl:e.rootDir.views+"notification/notificationList.html",link:function(e,n,i){e.pageSize=e.pageSize?e.pageSize:3,e.getNotifications=function(n){var i={page:n||1};i.page>1?e.gettingMore=!0:e.getting=!0,e.gettingErr=void 0,e.gettingMoreErr=void 0,t.getCompanyComments(e.company.id,{"page-size":e.pageSize,page:i.page}).then(function(t){e.itemList&&e.itemList.data&&i.page>1?(i.previousData=e.itemList.data,e.itemList=t.data,e.itemList.data=i.previousData.concat(e.itemList.data)):e.itemList=t.data},function(t){i.page>1?e.gettingMoreErr=t.data:e.gettingErr=t.data}).finally(function(){e.getting=void 0,e.gettingMore=void 0})},e.addedNewNotification=function(t){e.itemList.data.unshift(t),e.itemList.total=1*e.itemList.total+1},e.getNotifications()}}};angular.module("shmApp.directives").directive("notificationList",["appConf","CompanyService",e])}(),function(){"use strict";var e=function(e,t,n,i,a,r){var o=this;o.appUser=t,o.company=n,o.cancel=function(){e.dismiss("cancel")},o.save=function(){o.creating=!0,o.creatingErr=void 0,i.addCommentToAnCompany(o.company.id,{comments:o.message}).then(function(t){e.close(t.data),a.success(r.instant("NOTIFICATION.CREATED_SUCCESSFULLY"))},function(e){o.creatingErr=e.data}).finally(function(){o.creating=void 0})}},t=function(t,n,i){return{restrict:"A",scope:{appUser:"<",company:"<",succFunc:"&?"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"notification/notificationCreatePopupPanel.html",controller:["$uibModalInstance","appUser","company","CompanyService","toastr","$translate",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},company:function(){return i.company}}}).result.then(function(e){"function"==typeof i.succFunc&&"function"==typeof i.succFunc()&&i.succFunc()(e)})})}}};angular.module("shmApp.directives").directive("notificationCreatePopupBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i){var a=this;a.appUser=t,a.company=n,a.notification=i,a.cancel=function(){e.dismiss("cancel")}},t=function(t,n){return{restrict:"A",scope:{appUser:"<",company:"<",notification:"<"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,templateUrl:t.rootDir.views+"notification/NotificationDetailsPopupPanel.html",controller:["$uibModalInstance","appUser","company","notification",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},company:function(){return i.company},notification:function(){return i.notification}}}).result.then(function(e){!0===e&&(i.staff.active=0)})})}}};angular.module("shmApp.directives").directive("notificationDetailsPopupBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i){return{restrict:"AE",transclude:!0,scope:{appUser:"<?"},templateUrl:e.rootDir.views+"user/logoutBtn.html",link:function(e,a,r){e.logout=function(){t.logout(),n.go("login",{},{reload:!0}),i.appUser=void 0}}}};angular.module("shmApp.directives").directive("logoutBtn",["appConf","AuthService","$state","$rootScope",e])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{user:"<?"},templateUrl:e.rootDir.views+"user/userAvatar.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("userAvatar",["appConf",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{appUser:"<",item:"<",selectMode:"<?",selectedItem:"=?"},templateUrl:e.rootDir.views+"voucher/voucherGridItem.html",link:function(e,t,n){e.changeList=function(){e.selectedItem&&e.selectedItem.entity_id===e.item.id?e.selectedItem=void 0:e.selectedItem={entity_name:"App\\Modules\\Platform\\Models\\CompanyVoucherGroup",entity_id:e.item.id,entity:e.item}},e.maxOwnerShowing=4}}};angular.module("shmApp.directives").directive("voucherGridItem",["appConf","ItemService",e])}(),function(){"use strict";var e={available:1,expired:2,deleted:3,all:void 0},t=function(t,n,i,a){return{restrict:"AE",scope:{appUser:"<",company:"<"},templateUrl:t.rootDir.views+"voucher/voucherList.html",link:function(t,r,o){t.pageSize=t.pageSize?t.pageSize:12,t.searchTypes=e,t.type=e.available,t.searchObject={text:""},t._getItems=function(e,a){var r={page:e};n.displayCounts="",t.gettingErr=void 0,t.gettingMoreErr=void 0,r.page>1?t.gettingMore=!0:t.getting=!0,i.getVoucherGroupsUnderCompany(t.company.id,a).then(function(e){t.itemList&&t.itemList.data&&t.itemList.data.length>0&&r.page>1?(r.previousData=t.itemList.data,t.itemList=e.data,t.itemList.data=r.previousData.concat(e.data.data)):t.itemList=e.data,n.displayCounts=e.data.to?e.data.to+"/"+e.data.total:""},function(e){r.page>1?t.gettingMoreErr=e.data:t.gettingErr=e.data}).finally(function(){t.getting=void 0,t.gettingMore=void 0})},t.switchType=function(e){t.type=e,t.getItems()},t.navigateTo=function(e){a.go(e,{},{reload:!0})},t.getItems=function(n){var i={page:n||1};switch(i.params={"page-size":t.pageSize,page:i.page},t.searchObject&&t.searchObject.text&&""!=t.searchObject.text&&(i.params["key-word"]=t.searchObject.text),t.type){case e.available:i.params.available=1;break;case e.expired:i.params.unavailable=1;break;case e.deleted:i.params.deleted=1}t._getItems(n,i.params)},t.getItems()}}};angular.module("shmApp.directives").directive("voucherList",["appConf","$rootScope","CompanyService","$state",t])}(),function(){"use strict";var e=function(e,t,n,i,a,r){return{restrict:"AE",scope:{appUser:"<",company:"<",voucherId:"<?",cancelFunc:"&?"},templateUrl:e.rootDir.views+"voucher/voucherDetails.html",link:function(e,o,c){e.getVoucherGroup=function(n){e.gettingVoucher=!0,t.getVoucherGroupById(e.voucherId).then(function(t){e.voucherGroup=t.data,e.voucherGroup.end_date=moment(moment.utc(e.voucherGroup.end_date)).local().format("YYYY-MM-DD HH:mm"),i.editingVoucher=e.voucherGroup,"function"==typeof n&&n(e.voucherGroup)},function(t){e.gettingVoucherError=t.data}).finally(function(){e.gettingVoucher=!1})},e.startDateBeforeRender=function(e){var t=new Date,n=new Date(t);n.setDate(t.getDate()+1),n.setUTCHours(0,0,0,0),e.filter(function(e){return e.utcDateValue<n.getTime()}).forEach(function(e){e.selectable=!1})},e.cancel=function(){!0===e.hasCancelFunc&&e.cancelFunc()()},e.voucherSaved=function(e){r.go("backend.vouchers_details",{voucherGroupId:e.id},{reload:!0})},e.formatVoucher=function(t){return t.reedm_desc&&""!==t.reedm_desc||(t.reedm_desc=e.company.config&&e.company.config.defaultRedeemDesc?e.company.config.defaultRedeemDesc:""),t},e.getPreSaveCheckErr=function(){e.savingError={};var t={validObj:[]};if(e.voucherGroup.title&&""!==e.voucherGroup.title||(e.savingError.title=n.instant("VOUCHER.ERROR.TITLE.REQUIRED"),t.validObj.push(e.savingError.title)),e.voucherGroup.quantity&&""!==e.voucherGroup.quantity||(e.savingError.quantity=n.instant("VOUCHER.ERROR.QUANTITY.REQUIRED"),t.validObj.push(e.savingError.quantity)),e.voucherGroup.end_date&&""!==e.voucherGroup.end_date||(e.savingError.end_date=n.instant("VOUCHER.ERROR.EXPIRE_DATE.REQUIRED"),t.validObj.push(e.savingError.end_date)),e.voucherGroup.reedm_desc&&""!==e.voucherGroup.reedm_desc||(e.savingError.reedm_desc=n.instant("VOUCHER.ERROR.REDEEM.REQUIRED"),t.validObj.push(e.savingError.reedm_desc)),t.validObj.length>0)return a.getErrorMsgObj("",{"":t.validObj})},e.hasCancelFunc="function"==typeof e.cancelFunc&&"function"==typeof e.cancelFunc(),e.company=a.formatCompany(e.appUser,e.company),e.voucherId?e.getVoucherGroup(function(t){e.canEdit=!0===e.company.isCompanyAdmin&&""!==t.id||!0===e.appUser.is_admin,e.voucherGroup=e.formatVoucher(t)}):(e.canEdit=!0===e.company.isCompanyAdmin&&!0!==e.company.is_expired||!0===e.appUser.is_admin,e.voucherGroup=e.formatVoucher({company_id:e.company.id}),e.gettingVoucher=!1)}}};angular.module("shmApp.directives").directive("voucherDetails",["appConf","CompanyService","$translate","$rootScope","UtilsService","$state",e])}(),function(){"use strict";var e=function(e,t,n,i){var a=this;a.appUser=t,a.voucher=n,a.cancel=function(){e.dismiss("cancel")},a.getQrCodes=function(){a.totalQrCodes=0,a.getting=!0,a.gettingErr=void 0,i.genVoucherQrCode(a.voucher.id).then(function(e){a.qrcodes=e.data,angular.forEach(a.qrcodes,function(e,t){e&&null!==e&&""!==e?a.totalQrCodes=1*a.totalQrCodes+1:delete a.qrcodes[t]})},function(e){a.gettingErr=e.data}).finally(function(){a.getting=void 0})},a.getQrCodes()},t=function(t,n){return{restrict:"AE",scope:{appUser:"<",voucher:"<"},link:function(i,a,r){a.on("click",function(){n.open({animation:!0,
templateUrl:t.rootDir.views+"voucher/voucherQrCodePanel.html",controller:["$uibModalInstance","appUser","voucher","CompanyService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return i.appUser},voucher:function(){return i.voucher}}})})}}};angular.module("shmApp.directives").directive("voucherGroupQrCodePopupBtn",["appConf","$uibModal",t])}(),function(){"use strict";var e=function(e,t,n,i,a,r){var o=this;o.appUser=t,o.company=n,o.voucher=i,o.preCheckingErr=a,o.cancel=function(){e.dismiss("cancel")},o.save=function(){var t={};t.voucherData=angular.copy(o.voucher),t.voucherData.end_date=moment(moment(o.voucher.end_date)).utc().format("YYYY-MM-DD HH:mm:ss"),t.voucherData.voucher_img=t.voucherData.images[0]?t.voucherData.images[0]:"",t.savingFunc=o.voucher.id&&""!==o.voucher.id?r.updateCompanyVoucherGroup(o.voucher.id,t.voucherData):r.createCompanyVoucherGroup(t.voucherData),o.saving=!0,o.savingErr=void 0,t.savingFunc.then(function(t){o.voucher=t.data,e.close(o.voucher)},function(e){o.savingErr=e.data}).finally(function(){o.saving=void 0})}},t=function(t,n,i,a){return{restrict:"A",scope:{appUser:"<",company:"<",voucherSaveBtn:"=",succFunc:"&?",getPreCheckErrFunc:"&?"},link:function(r,o,c){o.on("click",function(){r.voucher=r.voucherSaveBtn,n.open({animation:!0,templateUrl:t.rootDir.views+"voucher/confirmSave.html",controller:["$uibModalInstance","appUser","company","voucher","preCheckingErr","CompanyService",e],controllerAs:"mdCtrl",resolve:{appUser:function(){return r.appUser},company:function(){return r.company},voucher:function(){return r.voucher},preCheckingErr:function(){if("function"==typeof r.getPreCheckErrFunc&&"function"==typeof r.getPreCheckErrFunc())return r.getPreCheckErrFunc()(r.voucher)}}}).result.then(function(e){r.voucher.id&&""!==r.voucher.id?i.success(a.instant("ITEM.UPDATE.SUCCESSFULLY")):i.success(a.instant("ITEM.CREATE.SUCCESSFULLY")),"function"==typeof r.succFunc&&"function"==typeof r.succFunc()&&r.succFunc()(e)})})}}};angular.module("shmApp.directives").directive("voucherSaveBtn",["appConf","$uibModal","toastr","$translate",t])}(),function(){"use strict";var e,t=function(t,n){e=this,e.customerServiceQrcodes=[n.rootDir.images+"kefu_new_1.png",n.rootDir.images+"kefu_new_4.png"],e.cancel=function(){t.dismiss("cancel")}},n=function(e,n,i){return{restrict:"AE",scope:{title:"@?",btnText:"@?"},template:'<div class="ask-customer-service-panel-wrapper text-center"><div class="panel-title" ng-if="title != \'\'">{{title}}</div><div class="panel-body"><button type="button" class="btn btn-info" ng-click="showContacts()" title="{{\'CUSTOMER_SERVICE.CLICK_HERE_TO_SHOW_CONTACTS\' | translate}}"><i class="fa fa-link"></i> <span>{{btnText}}</span></button></div></div>',link:function(e,a,r){e.showContacts=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",template:'<div class="customer-service-contacts-wrapper"><div class="modal-header"><span class="panel-title" translate="CUSTOMER_SERVICE.MODAL.TITLE"></span></div><div class="modal-body"><div class="row customer-service-qr-code-wrapper"><div class="customer-service-qr-code col-md-6 text-center" ng-repeat="img in mdCtrl.customerServiceQrcodes"><img ng-src="{{img}}" class="img-responsive"/></div></div></div><div class="modal-footer text-center"><button type="button" class="btn btn-success" translate="OK" ng-click="mdCtrl.cancel()"></button></div></div>',controller:["$uibModalInstance","appConf",t],controllerAs:"mdCtrl",size:void 0,appendTo:void 0})},e.btnText=e.btnText||i.instant("CLICK_HERE_TO_SHOW_CUSTOMER_CONTACTS")}}};angular.module("shmApp.directives").directive("askCustomerServicePanel",["$rootScope","$uibModal","$translate",n])}(),function(){"use strict";var e=function(e){return{restrict:"AE",scope:{},template:'<div class="count-to">{{displayingNumber}}</div>',link:function(t,n,i){t.update=function(){t.displayingNumber>=t.maxNumber?e.cancel(t.updater):t.displayingNumber=1*t.displayingNumber+1},t.displayingNumber=0,t.maxNumber=i.countTo,t.updater=e(t.update,Math.floor(900/t.maxNumber))}}};angular.module("shmApp.directives").directive("countTo",["$interval",e])}(),function(){"use strict";var e=function(e,t){return{restrict:"A",scope:{addressObj:"="},link:function(n,i,a){n.addressObj&&(n.addressGoogleObject=t.buildGooglePlacesResult(n.addressObj),i.val(n.addressGoogleObject.formatted_address)),e.then(function(){var e={};e.searchBox=new google.maps.places.SearchBox(i[0]),e.searchBox.addListener("places_changed",function(){e.places=e.searchBox.getPlaces(),n.addressObj=t.mapGoogleMapToAddressObj(e.places[0])})},function(){})}}};angular.module("shmApp.directives").directive("googlePlacesAutoComplete",["loadGoogleMapLib","UtilsService",e])}(),function(){"use strict";var e=function(){return{restrict:"AE",scope:{},template:'<div class="text-center"><div class="fa fa-spinner fa-spin fa-3x"></div></div>'}};angular.module("shmApp.directives").directive("loadingBar",e)}(),function(){"use strict";var e=function(e,t){return{restrict:"AE",scope:{},template:'<div class="opened-in-wechat-wrapper text-center" ng-if="openedInWechat === true"><div class="icon"><i class="fa fa-warning"></i></div><div translate="OPENED_IN_WECHAT_PLEASE_OPEN_IN_BROWSER"></div><div>{{url}}</div></div>',link:function(n,i,a){n.openedInWechat=t.openedInWeChat()||t.openInWindowsWechat(),e.openedInWechat=n.openedInWechat,n.url=window.location.href}}};angular.module("shmApp.directives").directive("openedInWeChatChecker",["$rootScope","WeChatService",e])}(),function(){"use strict";var e=function(e){return{restrict:"A",scope:{scrollingElementId:"@?"},template:"",link:function(t,n,i){t.offsetTop=angular.element(n).prop("offsetTop"),t.topClass=i.setClassWhenAtTop,t.listeningElement=t.scrollingElementId?angular.element("#"+t.scrollingElementId):angular.element(e),t.listeningElement.on("scroll",function(i){e.pageYOffset>=t.offsetTop?n.addClass(t.topClass):(n.removeClass(t.topClass),n.css({width:"auto"}))})}}};angular.module("shmApp.directives").directive("setClassWhenAtTop",["$window",e])}(),function(){"use strict";var e,t=function(t){return e=t,{restrict:"AE",scope:{errorObj:"<",msgOnly:"<?",hideCloseBtn:"<?"},templateUrl:t.rootDir.views+"showErrorFromJson.html",link:function(e,t,n){}}};angular.module("shmApp.directives").directive("showErrorFromJson",["appConf",t])}(),function(){"use strict";var e=function(e,t){e.editor.addButton("imagelink",{icon:"image",tooltip:t.instant("INSERT_IMAGE"),onclick:function(){e.showOptions(),e.$apply()}}),e.editor.addButton("fullscreen",{icon:"fullscreen",tooltip:t.instant("FULL_SCREEN"),onclick:function(){var t={};t.state=this.active(),t.state?angular.element(e.editor.editorContainer).removeClass("mce-fullscreen"):angular.element(e.editor.editorContainer).addClass("mce-fullscreen"),this.active(!t.state)}}),e.editor.on("Change",function(t){e.text=e.editor.getContent()})},t=function(t,n){return{restrict:"E",scope:{text:"=ngModel",height:"@?",companyId:"<",canEdit:"<"},templateUrl:t.rootDir.views+"textEditor.html",link:function(t,i,a){t.newAssets={images:[]},t.hideOptions=function(){t.showingOptions=!1},t.showOptions=function(){t.showingOptions=!0},t.insertAssets=function(e){angular.forEach(e,function(e){t.editor.insertContent('<div class="admin-page-uploaded-img-wrapper"><img src="'+e.url+'" style="width: 100%"/></div>')}),t.hideOptions()},t.tinymceOptions={menubar:!1,plugins:"textcolor colorpicker lists",toolbar:["undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | forecolor backcolor | imagelink | fullscreen"],preview_styles:"font-size color background-color",object_resizing:!1,branding:!1,height:t.height||"100vh",setup:function(i){t.editor=i,e(t,n)}}}}};angular.module("shmApp.directives").directive("textEditor",["appConf","$translate",t])}(),function(){"use strict";var e=function(e,t,n,i,a){return{restrict:"AE",scope:{maxNoOfImages:"@?",assets:"=",postSuccFunc:"&?",emptyAfterSucc:"<?",btnText:"@?",ngDisabled:"<?",companyId:"<"},templateUrl:e.rootDir.views+"uploadImg.html",link:function(e,t,i){e.signAssetsBack=function(){!0===e.srcIsArray?e.assets=angular.copy(e.aCopyOfAssets):!0===angular.isArray(e.aCopyOfAssets)&&e.aCopyOfAssets.length>0?e.assets=e.aCopyOfAssets[0]:e.assets={}},e.deleteAsset=function(t){var n={};angular.forEach(e.aCopyOfAssets,function(e,i){e.id===t.id&&(n.index=i)}),n.index>-1&&e.aCopyOfAssets.splice(n.index,1),e.signAssetsBack()},e.upload=function(t){t=t.slice(0,e.maxNoOfImages>=e.aCopyOfAssets.length?e.maxNoOfImages-e.aCopyOfAssets.length:0);var i=t.length;angular.forEach(t,function(t,a){var r={};if(r.arrayIndex=e.aCopyOfAssets.length,e.aCopyOfAssets.push({preProcessing:{uploading:!0,uploadingErr:void 0,originalFile:t}}),t.size/1e6>20)return void(e.aCopyOfAssets[r.arrayIndex].uploadingImgErr={message:$translate.instant("ITEM.PAGE.CREATE.VIDEO.OVER_SIZE",{size:"20MB"}),errors:{}});n.imgResize(t).then(function(t){n.uploadAsset(t,e.companyId).then(function(t){e.aCopyOfAssets[r.arrayIndex]=t.data,1*a+1===i&&(e.signAssetsBack(),"function"==typeof e.postSuccFunc&&"function"==typeof e.postSuccFunc()&&e.postSuccFunc()(e.aCopyOfAssets),!0===e.emptyAfterSucc&&(e.assets=void 0,e.init()))},function(t){e.init()}).finally(function(){})})})},e.init=function(){void 0===e.assets&&(1===e.maxNoOfImages?e.assets={}:e.assets=[]),e.srcIsArray=!1,e.aCopyOfAssets=angular.copy(e.assets),e.aCopyOfAssets&&(e.srcIsArray=angular.isArray(e.aCopyOfAssets),!0!==e.srcIsArray&&(e.aCopyOfAssets=[e.aCopyOfAssets])),!1===e.srcIsArray&&(e.maxNoOfImages=1)},e.maxNoOfImages=e.maxNoOfImages||1,e.maxFileSize="20MB",e.btnText=e.btnText||a.instant("UPLOAD_IMAGE.BTN.TITLE"),e.accumulationSize=0,e.init()}}};angular.module("shmApp.directives").directive("uploadImg",["appConf","Upload","AssetService","UtilsService","$translate",e])}(),function(){"use strict";var e=function(){return{restrict:"AE",scope:{data:"=ngModel",tags:"<"},template:'<div><tags-input ng-model="data" placeholder="{{\'COMPANY_TAGS.PLACEHOLDER\' | translate}}" allow-leftover-text="true" use-strings="true" add-on-space="true" min-length="1" class="tags-input">\n    <auto-complete source="tags"\n                   min-length="0"\n                   load-on-focus="true"\n                   load-on-empty="true"\n                   max-results-to-show="500"></auto-complete>\n</tags-input></div>'}};angular.module("shmApp.directives").directive("tagInput",[e])}(),function(){"use strict";var e=function(){return{restrict:"AE",scope:{data:"=ngModel",title:"<",inputId:"<"},template:'<div class="numInput"><div class="input-group pull-right"><div class="input-group-btn"><button type="button" class="btn btn-default btn-sm"ng-if="data >= 1" ng-click="minus()"><i class="fa fa-minus"></i></button></div><input class="form-control" name="{{title}}" min="0" ng-model="data" type="number" save="" oninput="validity.valid ? this.save = value : value = this.save;" placeholder="{{ \'SUPER_ADMIN.ITEM_ADD_JIELONG_MODAL.RESERVE.NO.LIMIT\' | translate }}"/><div class="input-group-btn"><button type="button" class="btn btn-success btn-sm"ng-click="add()"><i class = "fa fa-plus"></i></button></div></div></div>',link:function(e,t,n){e.minus=function(){e.data=e.data-1==0?"":e.data-1},e.add=function(){e.data=e.data?e.data+1:1}}}};angular.module("shmApp.directives").directive("inputNumber",e)}(),function(){"use strict";var e=function(e){return function(t){var n={};return n.parts=e("number")(t).split(","),1===n.parts.length?t:2===n.parts.length?(t/1e3).toFixed(1)+"K":3===n.parts.length?(t/1e6).toFixed(1)+"M":void 0}};angular.module("shmApp.filters").filter("shortNumber",["$filter",e])}(),function(){"use strict";var e=function(e){return function(t){return e.trustAsHtml(t)}};angular.module("shmApp.filters").filter("trustAsHtml",["$sce",e])}(),function(){"use strict";var e=function(){return function(e,t){if(e<=0)return"0 GB";if(isNaN(parseFloat(e))||!isFinite(e))return"-";void 0===t&&(t=2);var n=["bytes","kB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(i))).toFixed(t)+" "+n[i]}};angular.module("shmApp.filters").filter("BytesToGBFilter",e)}();